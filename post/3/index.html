<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.qiyunzhou.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#11a3fc","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="oracle1.基本概念1.1 数据库数据库是数据的物理存储。这就包括（数据文件ORA或者DBF、控制文件、联机日志、参数文件）。其实Oracle数据库的概念和其它数据库不一样，这里的数据库是一个操作系统只有一个库。可以看作是Oracle就只有一个大数据库。 1.2 实例Oracle官方描述：实例是访问Oracle数据库所需的一部分计算机内存和辅助处理后台进程，是由进程和这些进程所使用的内存(SG">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle">
<meta property="og:url" content="http://www.qiyunzhou.top/post/3/index.html">
<meta property="og:site_name" content="云州的博客">
<meta property="og:description" content="oracle1.基本概念1.1 数据库数据库是数据的物理存储。这就包括（数据文件ORA或者DBF、控制文件、联机日志、参数文件）。其实Oracle数据库的概念和其它数据库不一样，这里的数据库是一个操作系统只有一个库。可以看作是Oracle就只有一个大数据库。 1.2 实例Oracle官方描述：实例是访问Oracle数据库所需的一部分计算机内存和辅助处理后台进程，是由进程和这些进程所使用的内存(SG">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071550416.webp">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203081450171.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203081754150.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-08_22-15-50.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203091443600.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203101512894.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_23-00-07.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071556195.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203111454703.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203111539167.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203111642240.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203111656497.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_22-51-12.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_22-51-30.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203141046967.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203081022893.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203081049796.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203081049968.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203081129722.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203081110551.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071551617.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071552268.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071552858.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071552858.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071554902.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071555145.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071555810.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071555829.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203071555784.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203141642756.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203101630060.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203101626197.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203111006937.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203111010541.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_23-18-25.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_23-26-23.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203141100640.png">
<meta property="og:image" content="http://cdn.qiyunzhou.top/oracle/202203141424303.png">
<meta property="article:published_time" content="2021-10-06T14:56:36.000Z">
<meta property="article:modified_time" content="2022-03-25T12:50:51.089Z">
<meta property="article:author" content="yunzhou">
<meta property="article:tag" content="Oracle">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://cdn.qiyunzhou.top/oracle/202203071550416.webp">

<link rel="canonical" href="http://www.qiyunzhou.top/post/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Oracle | 云州的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  
   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas>
   <script type="text/javascript" src="/js/anime.js"></script> 
   <script type="text/javascript" src="/js/fireworks.js"></script>
  
  <script src="/live2d-widget/autoload.js"></script>
  
  <div class="container use-motion">

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">云州的博客</h1>
      <span class="logo-line-after">我们都是星尘</span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-words">

    <a href="/words/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>一言</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.qiyunzhou.top/post/3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/boy.jpg">
      <meta itemprop="name" content="yunzhou">
      <meta itemprop="description" content="看呐！那朵云好像一朵云">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云州的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Oracle
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-06 22:56:36" itemprop="dateCreated datePublished" datetime="2021-10-06T22:56:36+08:00">2021-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-25 20:50:51" itemprop="dateModified" datetime="2022-03-25T20:50:51+08:00">2022-03-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>32k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>29 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="oracle"><a href="#oracle" class="headerlink" title="oracle"></a>oracle</h1><h2 id="1-基本概念"><a href="#1-基本概念" class="headerlink" title="1.基本概念"></a>1.基本概念</h2><h3 id="1-1-数据库"><a href="#1-1-数据库" class="headerlink" title="1.1 数据库"></a>1.1 数据库</h3><p>数据库是数据的物理存储。这就包括（数据文件ORA或者DBF、控制文件、联机日志、参数文件）。其实Oracle数据库的概念和其它数据库不一样，这里的数据库是一个操作系统只有一个库。可以看作是Oracle就只有一个大数据库。</p>
<h3 id="1-2-实例"><a href="#1-2-实例" class="headerlink" title="1.2 实例"></a>1.2 实例</h3><p>Oracle官方描述：实例是访问Oracle数据库所需的一部分计算机内存和辅助处理后台进程，是由进程和这些进程所使用的内存(SGA)所构成一个集合。</p>
<p>实例名指的是用于响应某个数据库操作的数据库管理系统的名称。她同时也叫SID。实例名是由参数instance_name决定的。</p>
<p>数据库实例名(instance_name)用于对外部连接。在操作系统中要取得与数据库的联系，必须使用数据库实例名。比如我们作开发，要连接数据库，就得连接数据库实例名：</p>
<p>jdbc:oracle:thin:@localhost:1521:orcl（orcl就为数据库实例名）</p>
<p>一个数据库可以有多个实例，在作数据库服务集群的时候可以用到。</p>
<span id="more"></span>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询当前数据库实例名</span></span><br><span class="line"><span class="keyword">select</span> instance_name <span class="keyword">from</span> v$instance;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-表空间"><a href="#1-3-表空间" class="headerlink" title="1.3 表空间"></a>1.3 表空间</h3><p>表空间(tablespace)是一个用来管理数据存储逻辑概念，表空间只是和数据文件（ORA或者DBF文件）发生关系，数据文件是物理的，一个表空间可以包含多个数据文件，一个数据文件只能隶属一个表空间。</p>
<p>表空间(tablespace)是数据库的逻辑划分，每个数据库至少有一个表空间（称作SYSTEM表空间）。为了便于管理和提高运行效率，可以使用一些附加表空间来划分用户和应用程序。例如：USER表空间供一般用户使用，RBS表空间供回滚段使用。一个表空间只能属于一个数据库</p>
<h3 id="1-4-用户"><a href="#1-4-用户" class="headerlink" title="1.4 用户"></a>1.4 用户</h3><p>Oracle数据库建好后，要想在数据库里建表，必须先为数据库建立用户，并为用户指定表空间</p>
<p>用户是在实例下建立的，不同实例可以建相同名字的用户</p>
<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071550416.webp"></p>
<h3 id="1-5-数据文件（dbf、ora"><a href="#1-5-数据文件（dbf、ora" class="headerlink" title="1.5 数据文件（dbf、ora)"></a>1.5 数据文件（dbf、ora)</h3><p> 数据文件是数据库的物理存储单位。数据库的数据是存储在表空间中的，真 正是在某一个或者多个数据文件中。而一个表空间可以由一个或多个数据文件组成，一个数据文件只能属于一个表空间</p>
<p>ORACLE8i之前数据文件的后缀名为.ora,之后为.dbf,无论.ora或.dbf,实际使用没任何区别</p>
<p><font color='red'><strong>注：</strong></font>表的数据，是有用户放入某一个表空间的，而这个表空间会随机把这些表数据放到一个或者多个数据文件中。由于oracle的数据库不是普通的概念，oracle是有用户和表空间对数据进行管理和存放的。但是表不是有表空间去查询的，而是由用户去查的。因为不同用户可以在同一个表空间建立同一个名字的表，这里区分就是用户了。</p>
<h3 id="1-6-序列"><a href="#1-6-序列" class="headerlink" title="1.6 序列"></a>1.6 序列</h3><p>序列(SEQUENCE)是序列号生成器，可以为表中的行自动生成序列号，产生一组等间隔的数值(类型为数字)。不占用磁盘空间，占用内存。</p>
<p>其主要用途是生成表的主键值，可以在插入语句中引用，也可以通过查询检查当前值，或使序列增至下一个值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建序列</span></span><br><span class="line"><span class="keyword">create</span> sequence sequence  <span class="comment">-- 创建序列名称</span></span><br><span class="line">[increment <span class="keyword">by</span> n] <span class="comment">-- 递增的序列值是 n 如果 n 是正数就递增,如果是负数就递减 默认是 1</span></span><br><span class="line">[<span class="keyword">start</span> <span class="keyword">with</span> n] <span class="comment">-- 开始的值,递增默认是 minvalue 递减是 maxvalue</span></span><br><span class="line">[&#123;maxvalue n <span class="operator">|</span> nomaxvalue&#125;] <span class="comment">-- 最大值  </span></span><br><span class="line">[&#123;minvalue n <span class="operator">|</span> nominvalue&#125;] <span class="comment">-- 最小值</span></span><br><span class="line">[&#123;<span class="keyword">cycle</span> <span class="operator">|</span> nocycle&#125;] <span class="comment">-- 循环/不循环</span></span><br><span class="line">[&#123;cache n <span class="operator">|</span> nocache&#125;]; <span class="comment">-- 分配并存入到内存中</span></span><br><span class="line"><span class="comment">-- 修改序列</span></span><br><span class="line"><span class="keyword">alter</span> sequence sequence  </span><br><span class="line">[increment <span class="keyword">by</span> n] </span><br><span class="line">[<span class="keyword">start</span> <span class="keyword">with</span> n] </span><br><span class="line">[&#123;maxvalue n <span class="operator">|</span> nomaxvalue&#125;] </span><br><span class="line">[&#123;minvalue n <span class="operator">|</span> nominvalue&#125;] </span><br><span class="line">[&#123;<span class="keyword">cycle</span> <span class="operator">|</span> nocycle&#125;] </span><br><span class="line">[&#123;cache n <span class="operator">|</span> nocache&#125;];</span><br><span class="line"><span class="comment">-- 删除序列</span></span><br><span class="line"><span class="keyword">drop</span> sequence 序列名;</span><br></pre></td></tr></table></figure>

<p><strong>使用序列</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 序列调用 产生一个新的序列</span></span><br><span class="line"><span class="keyword">select</span> seq_test.nextval <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 查看当前序列的值</span></span><br><span class="line"><span class="keyword">select</span> seq_test.currval <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 清空 cache 中缓存的序列值</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">system</span> flush shared_pool;</span><br></pre></td></tr></table></figure>

<p><font color='red'>注：</font></p>
<ul>
<li>第一次使用currval前必须先调用nextval</li>
<li>如果创建带缓存的序列,缓存的值必须满足约束公式: 最大值-最小值&gt;=(缓存值-1)*每次循环的值</li>
<li>使用缓存会有产生断号的现象</li>
<li>创建一个循环序列,必须要设定最大值</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/100390025">Oracle - 数据库的实例、表空间、用户、表之间关系 - 知乎 (zhihu.com)</a></p>
</blockquote>
<h3 id="1-7-伪列"><a href="#1-7-伪列" class="headerlink" title="1.7 伪列"></a>1.7 伪列</h3><p>伪列的操作类似于表中的列，但是它不实际保存在表中。只能对其进行查询操作</p>
<p>rowid：是物理存在的，rowid是一种数据类型，它使用基于64为编码的18个字符来唯一标识一条记录物理位置的一个ID，为了唯一标识对应对象的物理位置</p>
<p>rownum：rownum是逻辑上的编号，且其值总是从1开始，每行的rounum不是固定的</p>
<pre><code>            rownum是动态的，也就是必须先有查询到的结果集，然后再给这个结果集加上一个列，且其值总是从1开始
</code></pre>
<h2 id="2-表空间"><a href="#2-表空间" class="headerlink" title="2. 表空间"></a>2. 表空间</h2><h3 id="2-1-创建表空间"><a href="#2-1-创建表空间" class="headerlink" title="2.1 创建表空间"></a>2.1 创建表空间</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span>space waterboss</span><br><span class="line">datafile <span class="string">&#x27;D:\app\HP\oradata\data\waterboss.dbf&#x27;</span></span><br><span class="line">size <span class="number">100</span>m</span><br><span class="line">autoextend <span class="keyword">on</span></span><br><span class="line">next <span class="number">10</span>m;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-删除表空间"><a href="#2-2-删除表空间" class="headerlink" title="2.2 删除表空间"></a>2.2 删除表空间</h3><p>(数据文件会一起删除)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> tablespace waterboss including contents <span class="keyword">and</span>  datafiles;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-用户"><a href="#2-3-用户" class="headerlink" title="2.3 用户"></a>2.3 用户</h3><p><strong>创建用户</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> wateruser</span><br><span class="line">identified <span class="keyword">by</span> root(密码)</span><br><span class="line"><span class="keyword">default</span> tablespace waterboss;</span><br></pre></td></tr></table></figure>

<p><strong>创建用户失败</strong></p>
<p>ORA-65096: 公用用户名或角色名无效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#oracle官方文档创建用户的时候用户名以c##或者C##开头</span><br><span class="line"><span class="keyword">alter</span> session <span class="keyword">set</span> &quot;_ORACLE_SCRIPT&quot;<span class="operator">=</span><span class="literal">true</span>;</span><br><span class="line"><span class="keyword">alter</span> session <span class="keyword">set</span> container<span class="operator">=</span>PDBORCL;</span><br></pre></td></tr></table></figure>

<p><strong>删除用户</strong></p>
<p>加了cascade就可以把用户连带的数据全部删掉。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> user_name cascade;</span><br></pre></td></tr></table></figure>

<p><strong>授予dba权限</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> dba <span class="keyword">to</span> wateruser;</span><br></pre></td></tr></table></figure>

<p><strong>解锁用户</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> scott account unlock;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> scott identified <span class="keyword">by</span> tiger(密码);</span><br></pre></td></tr></table></figure>

<h2 id="3-oracle函数"><a href="#3-oracle函数" class="headerlink" title="3. oracle函数"></a>3. oracle函数</h2><h3 id="3-1-数值型函数"><a href="#3-1-数值型函数" class="headerlink" title="3.1 数值型函数"></a>3.1 数值型函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ABS(X)</td>
<td>返回x的绝对值</td>
</tr>
<tr>
<td>sign(x)</td>
<td>返回x的正负值。若为正值返回1，负值返回-1，0返回0</td>
</tr>
<tr>
<td>ceil(x)</td>
<td>向上取整</td>
</tr>
<tr>
<td>floor(x)</td>
<td>向下取整</td>
</tr>
<tr>
<td>power(x,y)</td>
<td>返回x的y次幂</td>
</tr>
<tr>
<td>mod(x,y)</td>
<td>返回x除以y的余数</td>
</tr>
</tbody></table>
<h4 id="round-x，-y"><a href="#round-x，-y" class="headerlink" title="round(x，[y])"></a>round(x，[y])</h4><p>返回四舍五入后的值</p>
<p>如果y不为整数则截取y整数部分，<br>如果y&gt;0则四舍五入为y位小数，<br>如果y小于0则四舍五入到小数点向左第y位。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> round(<span class="number">5555.6666</span>,<span class="number">2.1</span>),round(<span class="number">5555.6666</span>,<span class="number">-2.6</span>),round(<span class="number">5555.6666</span>) <span class="keyword">from</span> dual;</span><br><span class="line">ROUND(<span class="number">5555.6666</span>,<span class="number">2.1</span>) ROUND(<span class="number">5555.6666</span>,<span class="number">-2.6</span>) ROUND(<span class="number">5555.6666</span>)</span><br><span class="line"><span class="comment">-------------------- --------------------- ----------------</span></span><br><span class="line">             <span class="number">5555.67</span>                  <span class="number">5600</span>             <span class="number">5556</span></span><br></pre></td></tr></table></figure>

<h4 id="trunc-number-decimals"><a href="#trunc-number-decimals" class="headerlink" title="trunc(number,[decimals])"></a>trunc(number,[decimals])</h4><p>用于截取时间或者数值，返回指定的值<br>decimals 参数可忽略，是要截取的位数，缺省时表示截掉小数点后边的值</p>
<p>如果y不为整数则截取y整数部分，<br>如果y&gt;0则截取到y位小数，<br>如果y小于0则截取到小数点向左第y位，小数前其它数据用0表示</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--123.56,将小数点右边指定位数后面的截去; </span></span><br><span class="line"><span class="keyword">select</span> trunc(<span class="number">123.567</span>,<span class="number">2</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">--100,第二个参数可以为负数，表示将小数点左边指定位数后面的部分截去，即均以0记;</span></span><br><span class="line"><span class="keyword">select</span> trunc(<span class="number">123.567</span>,<span class="number">-2</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">--123,默认截去小数点后面的部分;</span></span><br><span class="line"><span class="keyword">select</span> trunc(<span class="number">123.567</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>




<h3 id="3-2-字符型函数"><a href="#3-2-字符型函数" class="headerlink" title="3.2 字符型函数"></a>3.2 字符型函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>concat(c1,c2)</td>
<td>连接两个字符串</td>
</tr>
<tr>
<td>initcap(c1)</td>
<td>将字符串的第一个字母变为大写，其它字母小写</td>
</tr>
<tr>
<td>lower(c1)</td>
<td>将字符串全部转为小写</td>
</tr>
<tr>
<td>upper(c1)</td>
<td>将字符串全部转为大写</td>
</tr>
</tbody></table>
<h4 id="instr-c1-c2-x-y"><a href="#instr-c1-c2-x-y" class="headerlink" title="instr(c1,c2[,x],[y])"></a>instr(c1,c2[,x],[y])</h4><p>字符串中搜索字符位置</p>
<p>C1 被搜索的字符串<br>C2 希望搜索的字符串<br>x 搜索的开始位置,默认为1<br>y 第y次出现的位置,默认为1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> instr(<span class="string">&#x27;oracle traning&#x27;</span>,<span class="string">&#x27;ra&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>) instring <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">------------</span></span><br><span class="line"><span class="comment">-- 9</span></span><br></pre></td></tr></table></figure>

<h4 id="lpad-c1-n-c2"><a href="#lpad-c1-n-c2" class="headerlink" title="lpad(c1,n[,c2])"></a>lpad(c1,n[,c2])</h4><p>在左边添加字符。在字符串c1的左边用字符串c2填充，直到长度为n时为止</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> lpad(<span class="string">&#x27;杨&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;*&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-----------------</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>杨 (<span class="number">8</span>个<span class="operator">*</span>和一个字符)</span><br><span class="line"><span class="keyword">select</span> lpad(<span class="string">&#x27;*&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;*&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-------------------</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>    (<span class="number">10</span>个<span class="operator">*</span>)</span><br></pre></td></tr></table></figure>

<h4 id="rpad-c1-n-c2"><a href="#rpad-c1-n-c2" class="headerlink" title="rpad(c1,n[,c2])"></a>rpad(c1,n[,c2])</h4><p>在字符串c1的右边用字符串c2填充，直到长度为n时为止</p>
<h4 id="ltrim-c1-c2"><a href="#ltrim-c1-c2" class="headerlink" title="ltrim(c1,[,c2])"></a>ltrim(c1,[,c2])</h4><p>删除左边出现的字符串</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">select</span> LTRIM(<span class="string">&#x27;   xiao gong jiang&#x27;</span>,<span class="string">&#x27; &#x27;</span>) text <span class="keyword">from</span> dual;</span><br><span class="line"> <span class="comment">---------------</span></span><br><span class="line">xiao gong jiang</span><br></pre></td></tr></table></figure>

<h4 id="rtrim-c1-c2"><a href="#rtrim-c1-c2" class="headerlink" title="rtrim(c1,[,c2])"></a>rtrim(c1,[,c2])</h4><p>删除右边出现的字符串</p>
<h4 id="replace-c1-c2-c3"><a href="#replace-c1-c2-c3" class="headerlink" title="replace(c1,c2[,c3])"></a>replace(c1,c2[,c3])</h4><p>将字符表达式值中，部分相同字符串，替换成新的字符串</p>
<p>c1 希望被替换的字符或变量<br>c2 被替换的字符串<br>c3 要替换的字符串，默认为空(即删除之意，不是空格)</p>
<h4 id="substr-c1-n1-n2"><a href="#substr-c1-n1-n2" class="headerlink" title="substr(c1,n1[,n2])"></a>substr(c1,n1[,n2])</h4><p>取子字符串。在字符表达式c1里，从n1开始取n2个字符;若不指定n2,则从第y个字符直到结束的字串.</p>
<h4 id="translate-c1-c2-c3"><a href="#translate-c1-c2-c3" class="headerlink" title="translate(c1,c2,c3)"></a>translate(c1,c2,c3)</h4><p>将字符表达式值中，指定字符替换为新字符.</p>
<p>c1 希望被替换的字符或变量<br>c2 查询原始的字符集<br>c3 替换新的字符集，将c2对应顺序字符，替换为c3对应顺序字符<br>如果c3长度大于c2，则c3长出后面的字符无效<br>如果c3长度小于c2，则c2长出后面的字符均替换为空(删除)<br>如果c3长度为0，则返回空字符串。<br>如果c2里字符重复，按首次位置为替换依据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">TRANSLATE</span>(<span class="string">&#x27;he love you&#x27;</span>,<span class="string">&#x27;he&#x27;</span>,<span class="string">&#x27;i&#x27;</span>),</span><br><span class="line">  <span class="built_in">TRANSLATE</span>(<span class="string">&#x27;重庆的人&#x27;</span>,<span class="string">&#x27;重庆的&#x27;</span>,<span class="string">&#x27;上海男&#x27;</span>),</span><br><span class="line">  <span class="built_in">TRANSLATE</span>(<span class="string">&#x27;重庆的人&#x27;</span>,<span class="string">&#x27;重庆的重庆&#x27;</span>,<span class="string">&#x27;北京男士们&#x27;</span>),</span><br><span class="line">  <span class="built_in">TRANSLATE</span>(<span class="string">&#x27;重庆的人&#x27;</span>,<span class="string">&#x27;重庆的重庆&#x27;</span>,<span class="string">&#x27;1北京男士们&#x27;</span>),</span><br><span class="line">  <span class="built_in">TRANSLATE</span>(<span class="string">&#x27;重庆的人&#x27;</span>,<span class="string">&#x27;1重庆的重庆&#x27;</span>,<span class="string">&#x27;北京男士们&#x27;</span>),</span><br><span class="line">  <span class="built_in">TRANSLATE</span>(<span class="string">&#x27;aeiou&#x27;</span>, <span class="string">&#x27;1aeiou&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)<span class="keyword">from</span> dual;</span><br><span class="line">  <span class="comment">-----------------------------------------</span></span><br><span class="line">  i lov you,上海男人,北京男人,<span class="number">1</span>北京人,京男士人,<span class="keyword">null</span></span><br></pre></td></tr></table></figure>

<h4 id="trim-c1-from-c2"><a href="#trim-c1-from-c2" class="headerlink" title="trim(c1 from c2)"></a>trim(c1 from c2)</h4><p>删除左边和右边出现的字符串</p>
<h3 id="3-3-日期函数"><a href="#3-3-日期函数" class="headerlink" title="3.3 日期函数"></a>3.3 日期函数</h3><p>在Oracle中，date类型可以直接加减天数，而加减月份需要使用add_month函数</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>sysydate</td>
<td>返回当前日期</td>
</tr>
<tr>
<td>systimestamp</td>
<td>返回当前日期（包括微秒和时区）</td>
</tr>
<tr>
<td>add_months(d1,n1)</td>
<td>返回在日期d1基础上再加n1个月后新的日期</td>
</tr>
<tr>
<td>last_day(d1)</td>
<td>返回本月最后一天的日期</td>
</tr>
<tr>
<td>months_between(d1,d2)</td>
<td>返回日期d1到日期d2之间的月数</td>
</tr>
</tbody></table>
<h4 id="round-d1-c1"><a href="#round-d1-c1" class="headerlink" title="round(d1[,c1])"></a>round(d1[,c1])</h4><p>给出日期d1按期间(参数c1)四舍五入后的期间的第一天日期</p>
<p>d1日期型,c1为字符型(参数)，c1默认为j（即最近0点日期)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> sysdate 当时日期,</span><br><span class="line">  <span class="number">2</span>  round(sysdate) 最近<span class="number">0</span>点日期,</span><br><span class="line">  <span class="number">3</span>  round(sysdate,<span class="string">&#x27;day&#x27;</span>) 最近星期日,</span><br><span class="line">  <span class="number">4</span>  round(sysdate,<span class="string">&#x27;month&#x27;</span>) 最近月初,</span><br><span class="line">  <span class="number">5</span>  round(sysdate,<span class="string">&#x27;q&#x27;</span>) 最近季初日期,</span><br><span class="line">  <span class="number">6</span>  round(sysdate,<span class="string">&#x27;year&#x27;</span>) 最近年初日期 <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line">当时日期    最近<span class="number">0</span>点日期 最近星期日  最近月初    最近季初日期 最近年初日期</span><br><span class="line"><span class="comment">----------- ----------- ----------- ----------- ------------ ------------</span></span><br><span class="line"><span class="number">2016</span><span class="number">-5</span><span class="number">-25</span> <span class="number">0</span> <span class="number">2016</span><span class="number">-5</span><span class="number">-25</span>   <span class="number">2016</span><span class="number">-5</span><span class="number">-22</span>   <span class="number">2016</span><span class="number">-6</span><span class="number">-1</span>    <span class="number">2016</span><span class="number">-7</span><span class="number">-1</span>     <span class="number">2016</span><span class="number">-1</span><span class="number">-1</span></span><br></pre></td></tr></table></figure>

<h4 id="trunc-d1-c1"><a href="#trunc-d1-c1" class="headerlink" title="trunc(d1[,c1])"></a>trunc(d1[,c1])</h4><p>用于截取时间或者数值，返回指定的值</p>
<p>返回日期d1所在期间(参数c1)的第一天日期</p>
<p>d1日期型,c1为字符型(参数)，c1默认为j（即当前日期)</p>
<p>c1对应的参数表:<br>最近0点日期: 取消参数c1或j<br>最近的星期日：day或dy或d (每周顺序：日，一，二，三，四，五，六）<br>最近月初日期：month或mon或mm或rm<br>最近季日期：q<br>最近年初日期：syear或year或yyyy或yyy或yy或y(多个y表示精度)<br>最近世纪初日期：cc或scc</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sysdate                 当时日期,</span><br><span class="line">       trunc(sysdate)          今天日期,</span><br><span class="line">       trunc(sysdate, <span class="string">&#x27;day&#x27;</span>)   本周星期日,</span><br><span class="line">       trunc(sysdate, <span class="string">&#x27;month&#x27;</span>) 本月初,</span><br><span class="line">       trunc(sysdate, <span class="string">&#x27;q&#x27;</span>)     本季初日期,</span><br><span class="line">       trunc(sysdate, <span class="string">&#x27;year&#x27;</span>)  本年初日期</span><br><span class="line"><span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line">当时日期    今天日期    本周星期日  本月初      本季初日期  本年初日期</span><br><span class="line"><span class="comment">----------- ----------- ----------- ----------- ----------- -----------</span></span><br><span class="line"><span class="number">2016</span><span class="number">-5</span><span class="number">-25</span>  <span class="number">2016</span><span class="number">-5</span><span class="number">-25</span>   <span class="number">2016</span><span class="number">-5</span><span class="number">-22</span>   <span class="number">2016</span><span class="number">-5</span><span class="number">-1</span>    <span class="number">2016</span><span class="number">-4</span><span class="number">-1</span>    <span class="number">2016</span><span class="number">-1</span><span class="number">-1</span></span><br></pre></td></tr></table></figure>

<h4 id="extract-c1-from-d1"><a href="#extract-c1-from-d1" class="headerlink" title="extract(c1 from d1)"></a>extract(c1 from d1)</h4><p>提取时间日期中的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span></span><br><span class="line">  <span class="number">2</span>  <span class="built_in">extract</span>(<span class="keyword">hour</span> <span class="keyword">from</span> <span class="type">timestamp</span> <span class="string">&#x27;2001-2-16 2:38:40 &#x27;</span> ) 小时,</span><br><span class="line">  <span class="number">3</span>  <span class="built_in">extract</span>(<span class="keyword">minute</span> <span class="keyword">from</span> <span class="type">timestamp</span> <span class="string">&#x27;2001-2-16 2:38:40 &#x27;</span> ) 分钟,</span><br><span class="line">  <span class="number">4</span>  <span class="built_in">extract</span>(<span class="keyword">second</span> <span class="keyword">from</span> <span class="type">timestamp</span> <span class="string">&#x27;2001-2-16 2:38:40 &#x27;</span> ) 秒,</span><br><span class="line">  <span class="number">5</span>  <span class="built_in">extract</span>(<span class="keyword">DAY</span> <span class="keyword">from</span> <span class="type">timestamp</span> <span class="string">&#x27;2001-2-16 2:38:40 &#x27;</span> ) 日,</span><br><span class="line">  <span class="number">6</span>  <span class="built_in">extract</span>(<span class="keyword">MONTH</span> <span class="keyword">from</span> <span class="type">timestamp</span> <span class="string">&#x27;2001-2-16 2:38:40 &#x27;</span> ) 月,</span><br><span class="line">  <span class="number">7</span>  <span class="built_in">extract</span>(<span class="keyword">YEAR</span> <span class="keyword">from</span> <span class="type">timestamp</span> <span class="string">&#x27;2001-2-16 2:38:40 &#x27;</span> ) 年</span><br><span class="line">  <span class="number">8</span>   <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line">      小时       分钟         秒         日         月         年</span><br><span class="line"><span class="comment">---------- ---------- ---------- ---------- ---------- ----------</span></span><br><span class="line">         <span class="number">2</span>         <span class="number">38</span>         <span class="number">40</span>         <span class="number">16</span>          <span class="number">2</span>       <span class="number">2001</span></span><br></pre></td></tr></table></figure>

<h4 id="interval"><a href="#interval" class="headerlink" title="interval"></a>interval</h4><p>INTERVAL ‘integer [- integer]’ {YEAR | MONTH} [(precision)] [TO {YEAR | MONTH}]</p>
<p>表示一段时间差，precision为年或月的精确域, 有效范围是0到9, 默认值为2。</p>
<p>当增加一个比较复杂的时间段时，如“2天 12小时 30分 59秒”通过interval实现更加直观</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="type">interval</span> <span class="string">&#x27;123&#x27;</span> <span class="keyword">year</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> <span class="type">interval</span> <span class="string">&#x27;123&#x27;</span> <span class="keyword">month</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-----------------</span></span><br><span class="line">ORA<span class="number">-01873</span>: 间隔的前导精度太小</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="type">interval</span> <span class="string">&#x27;123&#x27;</span> <span class="keyword">year</span>(<span class="number">3</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="type">interval</span> <span class="string">&#x27;20&#x27;</span> <span class="keyword">year</span>                  <span class="keyword">year</span>,</span><br><span class="line">       <span class="type">interval</span> <span class="string">&#x27;20&#x27;</span> <span class="keyword">month</span>                 <span class="keyword">month</span>,</span><br><span class="line">       <span class="type">interval</span> <span class="string">&#x27;20-0&#x27;</span> <span class="keyword">year</span> <span class="keyword">to</span> <span class="keyword">month</span>       yearMonth,</span><br><span class="line">       <span class="type">interval</span> <span class="string">&#x27;20&#x27;</span> <span class="keyword">day</span>                   <span class="keyword">day</span>,</span><br><span class="line">       <span class="type">interval</span> <span class="string">&#x27;20&#x27;</span> <span class="keyword">hour</span>                  <span class="keyword">hour</span>,</span><br><span class="line">       <span class="type">interval</span> <span class="string">&#x27;80&#x27;</span> <span class="keyword">minute</span>                <span class="keyword">minute</span>,</span><br><span class="line">       <span class="type">interval</span> <span class="string">&#x27;80&#x27;</span> <span class="keyword">second</span>                <span class="keyword">second</span>,</span><br><span class="line">       <span class="type">interval</span> <span class="string">&#x27;0 20:0:0.0&#x27;</span> <span class="keyword">day</span> <span class="keyword">to</span> <span class="keyword">second</span> daySecond</span><br><span class="line"><span class="keyword">from</span> DUAL;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203081450171.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sysdate,</span><br><span class="line">       sysdate <span class="operator">-</span> <span class="type">interval</span> <span class="string">&#x27;10&#x27;</span> <span class="keyword">day</span>    <span class="keyword">as</span> &quot;10天前&quot;,</span><br><span class="line">       sysdate <span class="operator">-</span> <span class="type">interval</span> <span class="string">&#x27;10&#x27;</span> <span class="keyword">hour</span>   <span class="keyword">as</span> &quot;10小时前&quot;,</span><br><span class="line">       sysdate <span class="operator">-</span> <span class="type">interval</span> <span class="string">&#x27;10&#x27;</span> <span class="keyword">minute</span> <span class="keyword">as</span> &quot;10分钟前&quot;,</span><br><span class="line">       sysdate <span class="operator">-</span> <span class="type">interval</span> <span class="string">&#x27;10&#x27;</span> <span class="keyword">second</span> <span class="keyword">as</span> &quot;10秒钟前&quot;,</span><br><span class="line">       sysdate <span class="operator">-</span> <span class="number">10</span>                   <span class="keyword">as</span> &quot;10天前&quot;,</span><br><span class="line">       sysdate <span class="operator">-</span> <span class="number">10</span> <span class="operator">/</span> <span class="number">24</span>              <span class="keyword">as</span> &quot;10小时前&quot;,</span><br><span class="line">       sysdate <span class="operator">-</span> <span class="number">10</span> <span class="operator">/</span> (<span class="number">24</span> <span class="operator">*</span> <span class="number">60</span>)       <span class="keyword">as</span> &quot;10分钟前&quot;,</span><br><span class="line">       sysdate <span class="operator">-</span> <span class="number">10</span> <span class="operator">/</span> (<span class="number">24</span> <span class="operator">*</span> <span class="number">3600</span>)     <span class="keyword">as</span> &quot;10秒钟前&quot;</span><br><span class="line"><span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<h4 id="numtodsinterval"><a href="#numtodsinterval" class="headerlink" title="numtodsinterval"></a>numtodsinterval</h4><p>numtodsinterval(n, ‘interval_unit’)。将n转换成interval_unit所指定的值, interval_unit可以为: DAY, HOUR, MINUTE, SECOND<br><font color='red'>注意</font>该函数不可以转换成YEAR和MONTH的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> numtodsinterval(<span class="number">100</span>, <span class="string">&#x27;day&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">----------------------------</span></span><br><span class="line"><span class="number">100</span> <span class="number">0</span>:<span class="number">0</span>:<span class="number">0.0</span></span><br></pre></td></tr></table></figure>

<h4 id="加减日月年"><a href="#加减日月年" class="headerlink" title="加减日月年"></a>加减日月年</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> HIREDATE,</span><br><span class="line">       HIREDATE <span class="operator">-</span> <span class="number">5</span>                  <span class="keyword">as</span> 减<span class="number">5</span>天,</span><br><span class="line">       add_months(HIREDATE, <span class="number">-5</span>)      <span class="keyword">as</span> 减<span class="number">5</span>个月,</span><br><span class="line">       add_months(HIREDATE, <span class="number">-5</span> <span class="operator">*</span> <span class="number">12</span>) <span class="keyword">as</span> 减<span class="number">5</span>年</span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h4 id="加减时分秒"><a href="#加减时分秒" class="headerlink" title="加减时分秒"></a>加减时分秒</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> HIREDATE,</span><br><span class="line">       HIREDATE <span class="operator">-</span> <span class="number">5</span> <span class="keyword">as</span> 减<span class="number">5</span>小时,</span><br><span class="line">       HIREDATE <span class="operator">-</span> <span class="number">5</span> <span class="keyword">as</span> 减<span class="number">5</span>分钟,</span><br><span class="line">       HIREDATE <span class="operator">-</span> <span class="number">5</span> <span class="keyword">as</span> 减<span class="number">5</span>秒</span><br><span class="line"><span class="keyword">from</span> EMP</span><br><span class="line"><span class="keyword">where</span> ROWNUM <span class="operator">&lt;=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h4 id="计算两个日期之间的工作天数"><a href="#计算两个日期之间的工作天数" class="headerlink" title="计算两个日期之间的工作天数"></a>计算两个日期之间的工作天数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 原始数据</span></span><br><span class="line"><span class="keyword">select</span> ename,HIREDATE <span class="keyword">from</span> emp <span class="keyword">where</span> ENAME <span class="keyword">in</span> (<span class="string">&#x27;SMITH&#x27;</span>,<span class="string">&#x27;ALLEN&#x27;</span>);</span><br><span class="line"><span class="comment">-- 通过聚合函数转化为一行</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(HIREDATE) min_hd,<span class="built_in">max</span>(HIREDATE) max_hd <span class="keyword">from</span> emp <span class="keyword">where</span> ENAME <span class="keyword">in</span> (<span class="string">&#x27;SMITH&#x27;</span>,<span class="string">&#x27;ALLEN&#x27;</span>);</span><br><span class="line"><span class="comment">-- 两个日期之间的天数要+1</span></span><br><span class="line"><span class="keyword">select</span> (max_hd <span class="operator">-</span> min_hd) <span class="keyword">as</span> 天数</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">         <span class="keyword">select</span> <span class="built_in">min</span>(HIREDATE) min_hd, <span class="built_in">max</span>(HIREDATE) max_hd <span class="keyword">from</span> emp <span class="keyword">where</span> ENAME <span class="keyword">in</span> (<span class="string">&#x27;SMITH&#x27;</span>, <span class="string">&#x27;ALLEN&#x27;</span>)</span><br><span class="line">     ); </span><br><span class="line"><span class="comment">-- 通过笛卡尔积枚举两个日期间所有的天数</span></span><br><span class="line"><span class="keyword">with</span> temp <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">min</span>(HIREDATE) min_hd, <span class="built_in">max</span>(HIREDATE) max_hd <span class="keyword">from</span> emp <span class="keyword">where</span> ENAME <span class="keyword">in</span> (<span class="string">&#x27;SMITH&#x27;</span>, <span class="string">&#x27;ALLEN&#x27;</span>)</span><br><span class="line">),</span><br><span class="line">     tnum <span class="keyword">as</span> (</span><br><span class="line">         <span class="keyword">select</span> temp.<span class="operator">*</span>, ROWNUM <span class="keyword">as</span> id <span class="keyword">from</span> temp <span class="keyword">connect</span> <span class="keyword">by</span> ROWNUM <span class="operator">&lt;=</span> (max_hd <span class="operator">-</span> min_hd <span class="operator">+</span> <span class="number">1</span>)</span><br><span class="line">     )</span><br><span class="line"><span class="keyword">select</span> tnum.min_hd <span class="operator">+</span> (tnum.id <span class="operator">-</span> <span class="number">1</span>) <span class="keyword">as</span> dates</span><br><span class="line"><span class="keyword">from</span> tnum;     </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--根据这些日期得到对应的工作日信息</span></span><br><span class="line"><span class="keyword">select</span> dates, to_char(dates, <span class="string">&#x27;DY&#x27;</span>, <span class="string">&#x27;NLS_DATE_LANGUAGE = American&#x27;</span>) <span class="keyword">as</span> dy <span class="comment">-- 设置日期语言</span></span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">         <span class="keyword">with</span> temp <span class="keyword">as</span> (</span><br><span class="line">             <span class="keyword">select</span> <span class="built_in">min</span>(HIREDATE) min_hd, <span class="built_in">max</span>(HIREDATE) max_hd <span class="keyword">from</span> emp <span class="keyword">where</span> ENAME <span class="keyword">in</span> (<span class="string">&#x27;SMITH&#x27;</span>, <span class="string">&#x27;ALLEN&#x27;</span>)</span><br><span class="line">         ),</span><br><span class="line">              tnum <span class="keyword">as</span> (</span><br><span class="line">                  <span class="keyword">select</span> temp.<span class="operator">*</span>, ROWNUM <span class="keyword">as</span> id <span class="keyword">from</span> temp <span class="keyword">connect</span> <span class="keyword">by</span> ROWNUM <span class="operator">&lt;=</span> (max_hd <span class="operator">-</span> min_hd <span class="operator">+</span> <span class="number">1</span>)</span><br><span class="line">              )</span><br><span class="line">         <span class="keyword">select</span> tnum.min_hd <span class="operator">+</span> (tnum.id <span class="operator">-</span> <span class="number">1</span>) <span class="keyword">as</span> dates</span><br><span class="line">         <span class="keyword">from</span> tnum</span><br><span class="line">     );</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203081754150.png"></p>
<h4 id="常用日期取值"><a href="#常用日期取值" class="headerlink" title="常用日期取值"></a>常用日期取值</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> HIREDATE,</span><br><span class="line">       to_number(to_char(HIREDATE, <span class="string">&#x27;hh24&#x27;</span>)) 时,</span><br><span class="line">       to_number(to_char(HIREDATE, <span class="string">&#x27;mi&#x27;</span>)) 分,</span><br><span class="line">       to_number(to_char(HIREDATE, <span class="string">&#x27;ss&#x27;</span>)) 秒,</span><br><span class="line">       to_number(to_char(HIREDATE, <span class="string">&#x27;dd&#x27;</span>)) 日,</span><br><span class="line">       to_number(to_char(HIREDATE, <span class="string">&#x27;mm&#x27;</span>)) 月,</span><br><span class="line">       to_number(to_char(HIREDATE, <span class="string">&#x27;yyyy&#x27;</span>)) 年,</span><br><span class="line">       to_number(to_char(HIREDATE, <span class="string">&#x27;ddd&#x27;</span>)) 年内第几天,</span><br><span class="line">       trunc(HIREDATE, <span class="string">&#x27;dd&#x27;</span>) 一天之始,</span><br><span class="line">       trunc(HIREDATE, <span class="string">&#x27;day&#x27;</span>) 周初,</span><br><span class="line">       trunc(to_char(HIREDATE, <span class="string">&#x27;mm&#x27;</span>)) 月初,</span><br><span class="line">       last_day(HIREDATE) 月末,</span><br><span class="line">       add_months(trunc(HIREDATE, <span class="string">&#x27;mm&#x27;</span>),<span class="number">1</span>) 下月初,</span><br><span class="line">       trunc(HIREDATE, <span class="string">&#x27;yy&#x27;</span>) 年初,</span><br><span class="line">       to_char(HIREDATE, <span class="string">&#x27;day&#x27;</span>) 周几,</span><br><span class="line">       to_char(HIREDATE, <span class="string">&#x27;month&#x27;</span>) 月份</span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h4 id="确定一年是否为闰年"><a href="#确定一年是否为闰年" class="headerlink" title="确定一年是否为闰年"></a>确定一年是否为闰年</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> trunc(HIREDATE, <span class="string">&#x27;year&#x27;</span>) 年初</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> EMPNO <span class="operator">=</span> <span class="number">7369</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> add_months(trunc(HIREDATE, <span class="string">&#x27;y&#x27;</span>),<span class="number">1</span>) 二月初</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> EMPNO <span class="operator">=</span> <span class="number">7369</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> last_day(add_months(trunc(HIREDATE, <span class="string">&#x27;y&#x27;</span>),<span class="number">1</span>)) 二月底</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> EMPNO <span class="operator">=</span> <span class="number">7369</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> to_char(last_day(add_months(trunc(HIREDATE, <span class="string">&#x27;y&#x27;</span>),<span class="number">1</span>)), <span class="string">&#x27;dd&#x27;</span>) 日</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> EMPNO <span class="operator">=</span> <span class="number">7369</span>;</span><br></pre></td></tr></table></figure>

<h4 id="确定一年内属于周内某一天的所有日期"><a href="#确定一年内属于周内某一天的所有日期" class="headerlink" title="确定一年内属于周内某一天的所有日期"></a>确定一年内属于周内某一天的所有日期</h4><p>返回指定年份中的所有周五</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 求出今年的所有日期</span></span><br><span class="line"><span class="keyword">select</span> trunc(sysdate, <span class="string">&#x27;y&#x27;</span>) <span class="operator">+</span> (level <span class="operator">-</span> <span class="number">1</span>) dy</span><br><span class="line"><span class="keyword">from</span> dual</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> add_months(trunc(sysdate, <span class="string">&#x27;y&#x27;</span>), <span class="number">12</span>) <span class="operator">-</span> trunc(sysdate, <span class="string">&#x27;y&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 返回指定年份的所有周五</span></span><br><span class="line"><span class="keyword">with</span> temp <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span> trunc(sysdate, <span class="string">&#x27;y&#x27;</span>) <span class="operator">+</span> (level <span class="operator">-</span> <span class="number">1</span>) dy</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">    <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> add_months(trunc(sysdate, <span class="string">&#x27;y&#x27;</span>), <span class="number">12</span>) <span class="operator">-</span> trunc(sysdate, <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> dy, to_char(dy, <span class="string">&#x27;day&#x27;</span>) <span class="keyword">as</span> 周五</span><br><span class="line"><span class="keyword">from</span> temp</span><br><span class="line"><span class="keyword">where</span> to_char(dy, <span class="string">&#x27;d&#x27;</span>) <span class="operator">=</span> <span class="number">6</span>;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-08_22-15-50.png"></p>
<p>创建月日历</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> temp <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span> trunc(sysdate, <span class="string">&#x27;mm&#x27;</span>)                monthfirst,</span><br><span class="line">           add_months(trunc(sysdate, <span class="string">&#x27;mm&#x27;</span>), <span class="number">1</span>) next_monthfirst</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">),</span><br><span class="line">     tnum <span class="keyword">as</span> (</span><br><span class="line">         <span class="keyword">select</span> temp.<span class="operator">*</span>, level <span class="keyword">as</span> id <span class="keyword">from</span> temp <span class="keyword">connect</span> <span class="keyword">by</span> LEVEL <span class="operator">&lt;=</span> (next_monthfirst <span class="operator">-</span> monthfirst)</span><br><span class="line">     ),</span><br><span class="line">     currentmonths <span class="keyword">as</span> (</span><br><span class="line">         <span class="keyword">select</span> tnum.monthfirst <span class="operator">+</span> (tnum.id <span class="operator">-</span> <span class="number">1</span>) <span class="keyword">as</span> dates</span><br><span class="line">         <span class="keyword">from</span> tnum</span><br><span class="line">     ),</span><br><span class="line">     weekinfo <span class="keyword">as</span> (</span><br><span class="line">         <span class="keyword">select</span> to_char(dates, <span class="string">&#x27;iw&#x27;</span>)           所在周,</span><br><span class="line">                to_char(dates, <span class="string">&#x27;dd&#x27;</span>)           日期,</span><br><span class="line">                to_number(to_char(dates, <span class="string">&#x27;d&#x27;</span>)) 周几</span><br><span class="line">         <span class="keyword">from</span> currentmonths</span><br><span class="line">     )</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(<span class="keyword">case</span> 周几 <span class="keyword">when</span> <span class="number">2</span> <span class="keyword">then</span> 日期 <span class="keyword">end</span>) 周一,</span><br><span class="line">       <span class="built_in">max</span>(<span class="keyword">case</span> 周几 <span class="keyword">when</span> <span class="number">3</span> <span class="keyword">then</span> 日期 <span class="keyword">end</span>) 周二,</span><br><span class="line">       <span class="built_in">max</span>(<span class="keyword">case</span> 周几 <span class="keyword">when</span> <span class="number">4</span> <span class="keyword">then</span> 日期 <span class="keyword">end</span>) 周三,</span><br><span class="line">       <span class="built_in">max</span>(<span class="keyword">case</span> 周几 <span class="keyword">when</span> <span class="number">5</span> <span class="keyword">then</span> 日期 <span class="keyword">end</span>) 周四,</span><br><span class="line">       <span class="built_in">max</span>(<span class="keyword">case</span> 周几 <span class="keyword">when</span> <span class="number">6</span> <span class="keyword">then</span> 日期 <span class="keyword">end</span>) 周五,</span><br><span class="line">       <span class="built_in">max</span>(<span class="keyword">case</span> 周几 <span class="keyword">when</span> <span class="number">7</span> <span class="keyword">then</span> 日期 <span class="keyword">end</span>) 周六,</span><br><span class="line">       <span class="built_in">max</span>(<span class="keyword">case</span> 周几 <span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> 日期 <span class="keyword">end</span>) 周天</span><br><span class="line"><span class="keyword">from</span> weekinfo</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 所在周</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 所在周;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203091443600.png"></p>
<h3 id="3-4转换函数"><a href="#3-4转换函数" class="headerlink" title="3.4转换函数"></a>3.4转换函数</h3><h4 id="TO-CHAR-x-c2-C3-C4"><a href="#TO-CHAR-x-c2-C3-C4" class="headerlink" title="TO_CHAR(x[[[,c2],C3],C4])"></a>TO_CHAR(x[[[,c2],C3],C4])</h4><p>将日期或数据转换为char数据类型</p>
<p>如果x为日期控制返回的月份和日份所使用的语言。<br>如果x为数字用来指定小数位和千分位的分隔符，以及货币符号。</p>
<p>第三个参数C4可以设置字符集 nls_date_language=american</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> to_char(sysdate, <span class="string">&#x27;day&#x27;</span>, <span class="string">&#x27;NLS_DATE_LANGUAGE=American&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">---------------</span></span><br><span class="line">thursday </span><br></pre></td></tr></table></figure>

<p><strong>使用</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- x为数据型时</span></span><br><span class="line">to_char(<span class="number">1210.73</span>, <span class="string">&#x27;9999.9&#x27;</span>) 返回 <span class="string">&#x27;1210.7&#x27;</span> </span><br><span class="line">to_char(<span class="number">1210.73</span>, <span class="string">&#x27;9,999.99&#x27;</span>) 返回 <span class="string">&#x27;1,210.73&#x27;</span> </span><br><span class="line">to_char(<span class="number">1210.73</span>, <span class="string">&#x27;$9,999.00&#x27;</span>) 返回 <span class="string">&#x27;$1,210.73&#x27;</span> </span><br><span class="line">to_char(<span class="number">21</span>, <span class="string">&#x27;000099&#x27;</span>) 返回 <span class="string">&#x27;000021&#x27;</span> </span><br><span class="line">to_char(<span class="number">852</span>,<span class="string">&#x27;xxxx&#x27;</span>) 返回<span class="string">&#x27; 354&#x27;</span> <span class="comment">-- 将10进制转换为16进制；</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- x为日期型,c2可用参数</span></span><br><span class="line">to_char(sysdate,<span class="string">&#x27;d&#x27;</span>) 每周第几天 </span><br><span class="line">to_char(sysdate,<span class="string">&#x27;dd&#x27;</span>) 每月第几天 </span><br><span class="line">to_char(sysdate,<span class="string">&#x27;ddd&#x27;</span>) 每年第几天 </span><br><span class="line">to_char(sysdate,<span class="string">&#x27;ww&#x27;</span>) 每年第几周 </span><br><span class="line">to_char(sysdate,<span class="string">&#x27;mm&#x27;</span>) 每年第几月 </span><br><span class="line">to_char(sysdate,<span class="string">&#x27;q&#x27;</span>) 每年第几季 </span><br><span class="line">to_char(sysdate,<span class="string">&#x27;yyyy&#x27;</span>) 年</span><br></pre></td></tr></table></figure>

<p><strong>格式列表</strong></p>
<table>
<thead>
<tr>
<th>格式</th>
<th>说明</th>
<th>显示值</th>
</tr>
</thead>
<tbody><tr>
<td>YEAR</td>
<td>年（英文大写）</td>
<td>TWENTY TWENTY-TWO</td>
</tr>
<tr>
<td>Year</td>
<td>年(英文首字母大写)</td>
<td>Twenty Twenty-Two</td>
</tr>
<tr>
<td>yyyy</td>
<td>四位年</td>
<td>2022</td>
</tr>
<tr>
<td>yy</td>
<td>两位年</td>
<td>22</td>
</tr>
<tr>
<td>BC or B.C. or AD or A.D. yyyy</td>
<td>年标识</td>
<td>公元 2022</td>
</tr>
<tr>
<td>MONTH</td>
<td>月份(字符集表示,9字符)</td>
<td>3月,MARCH</td>
</tr>
<tr>
<td>month</td>
<td>月份(字符集表示,9字符)</td>
<td>3月,march</td>
</tr>
<tr>
<td>mon</td>
<td>月份(字符集表示,3字符)</td>
<td>3月,mar</td>
</tr>
<tr>
<td>MM or mm</td>
<td>月份</td>
<td>03</td>
</tr>
<tr>
<td>DAY</td>
<td>天(全大写,9字符)</td>
<td>星期四,THURSDAY</td>
</tr>
<tr>
<td>Day</td>
<td>天(首字母大写,9字符)</td>
<td>星期四,Thursday</td>
</tr>
<tr>
<td>day</td>
<td>天(全小写,9字符)</td>
<td>星期四,thursday</td>
</tr>
<tr>
<td>DY</td>
<td>天(全大写,3字符)</td>
<td>星期四,THU</td>
</tr>
<tr>
<td>Dy</td>
<td>天(首字母大写,3字符)</td>
<td>星期四,Thu</td>
</tr>
<tr>
<td>dy</td>
<td>天(全小写,3字符)</td>
<td>星期四,thu</td>
</tr>
<tr>
<td>W or w</td>
<td>一个月里的周数</td>
<td>2</td>
</tr>
<tr>
<td><font color='red'>*</font>WW or ww</td>
<td>一年里的周数</td>
<td>10</td>
</tr>
<tr>
<td><font color='red'>*</font>IW or iw</td>
<td>一年里的周数</td>
<td>10</td>
</tr>
<tr>
<td>cc</td>
<td>世纪</td>
<td>21</td>
</tr>
<tr>
<td>j</td>
<td>Julian 日期（自公元前4712年1月1日来的日期）</td>
<td>2459649</td>
</tr>
<tr>
<td>Q or q</td>
<td>季度</td>
<td>1</td>
</tr>
<tr>
<td>RM</td>
<td>罗马数字的月份（I-XII；I=JAN）－大写</td>
<td>III</td>
</tr>
<tr>
<td>rm</td>
<td>罗马数字的月份（I-XII；I=JAN）－大写</td>
<td>iii</td>
</tr>
</tbody></table>
<p><font color='red'>注：</font></p>
<p>ww的算法为每年1月1日为第一周开始，date+6为每一周结尾；iw的算法为星期一至星期日算一周，且每年的第一个星期一为第一周</p>
<p><strong>填充模式</strong></p>
<p>to_char(numeric, ‘FM99999990.00’)</p>
<ul>
<li>其9代表：如果存在数字则显示数字</li>
<li>其0代表：如果存在数字则显示数字，不存在则显示0，即占位符</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> to_char(<span class="number">9999.09556</span>,<span class="string">&#x27;fm99999.0900&#x27;</span>),to_char(<span class="number">9999.09556</span>,<span class="string">&#x27;fm00099.0900&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">--------------------------</span></span><br><span class="line"><span class="number">9999.0956</span>   <span class="number">09999.0956</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> Tmp <span class="keyword">As</span>(</span><br><span class="line">    <span class="keyword">Select</span> <span class="number">2312320.012</span> n <span class="keyword">From</span> dual <span class="keyword">Union</span> <span class="keyword">All</span></span><br><span class="line">    <span class="keyword">Select</span> <span class="number">0.012322</span> n <span class="keyword">From</span> dual <span class="keyword">Union</span> <span class="keyword">All</span></span><br><span class="line">    <span class="keyword">Select</span> <span class="number">0.012564</span> n <span class="keyword">From</span> dual <span class="keyword">Union</span> <span class="keyword">All</span></span><br><span class="line">    <span class="keyword">Select</span> <span class="number">-0.012</span> n <span class="keyword">From</span> dual <span class="keyword">Union</span> <span class="keyword">All</span></span><br><span class="line">    <span class="keyword">Select</span> <span class="number">-10023</span> n <span class="keyword">From</span> dual <span class="keyword">Union</span> <span class="keyword">All</span></span><br><span class="line">    <span class="keyword">Select</span> <span class="number">8989898</span> n <span class="keyword">From</span> dual)</span><br><span class="line"><span class="keyword">Select</span> <span class="comment">--全部为 9</span></span><br><span class="line">       To_Char(t.n, <span class="string">&#x27;9999999999.9999999&#x27;</span>) all_9,</span><br><span class="line">       <span class="comment">--全部为 9 同时使用 FM</span></span><br><span class="line">       To_Char(t.n, <span class="string">&#x27;FM999999999999999.9999999&#x27;</span>) all_FM9,</span><br><span class="line">       <span class="comment">--全部为 0</span></span><br><span class="line">       To_Char(t.n, <span class="string">&#x27;000000000.0000000&#x27;</span>) all_0,</span><br><span class="line">       <span class="comment">--全部为 0 同时使用 FM</span></span><br><span class="line">       To_Char(t.n, <span class="string">&#x27;FM000000000.0000000&#x27;</span>) all_FM0,</span><br><span class="line">       <span class="comment">--个位开始向右使用 0 向左使用9</span></span><br><span class="line">       To_Char(t.n, <span class="string">&#x27;9999999990.0000000&#x27;</span>) some9one0,</span><br><span class="line">       <span class="comment">--个位开始向右使用 0 向左使用9 同时使用FM</span></span><br><span class="line">       To_Char(t.n, <span class="string">&#x27;FM999999999999990.00000000&#x27;</span>) some9one0P0_FM,</span><br><span class="line">       <span class="comment">--个位使用 0 同时使用FM</span></span><br><span class="line">       To_Char(t.n, <span class="string">&#x27;FM999999999999990.99999999&#x27;</span>) some9one0P9_FM,</span><br><span class="line">       <span class="comment">--个位使用 0 前四位小数位使用 0 同时使用FM</span></span><br><span class="line">       To_Char(t.n, <span class="string">&#x27;FM999999999999990.0000999&#x27;</span>) some9one0P09_FM</span><br><span class="line">  <span class="keyword">From</span> tmp t;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203101512894.png"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lushanyanyu/p/10916821.html">oracle to_Char fm 函数 - 庐山烟雨 - 博客园 (cnblogs.com)</a></p>
</blockquote>
<p><strong>数字格式</strong></p>
<table>
<thead>
<tr>
<th>格式元素</th>
<th>元素说明</th>
<th>格式</th>
<th>数字</th>
<th>字符结果</th>
</tr>
</thead>
<tbody><tr>
<td>9</td>
<td>数字宽度</td>
<td>9999</td>
<td>12</td>
<td>12</td>
</tr>
<tr>
<td>0</td>
<td>显示前面的0</td>
<td>0999</td>
<td>12</td>
<td>0012</td>
</tr>
<tr>
<td>.</td>
<td>小数点的位置</td>
<td>099.99</td>
<td>02.4</td>
<td>002.40</td>
</tr>
<tr>
<td>D</td>
<td>小数分割点的位置</td>
<td>099D99</td>
<td>09.9</td>
<td>009.90</td>
</tr>
<tr>
<td>，</td>
<td>逗号的位置</td>
<td>099,999</td>
<td>09080</td>
<td>009,080</td>
</tr>
<tr>
<td>G</td>
<td>组分隔符的位置</td>
<td>099G999</td>
<td>09080</td>
<td>009,080</td>
</tr>
<tr>
<td>$</td>
<td>美元符号</td>
<td>$099</td>
<td>9</td>
<td>$009</td>
</tr>
<tr>
<td>L</td>
<td>当地货币</td>
<td>L099</td>
<td>9</td>
<td>GBP009（如果nls_currency设置为GBP）</td>
</tr>
<tr>
<td>MI</td>
<td>表示复数的减号的位置</td>
<td>9999MI</td>
<td>-9876</td>
<td>9876-</td>
</tr>
<tr>
<td>PR</td>
<td>包围在括号内的负数</td>
<td>999PR</td>
<td>-98</td>
<td>&lt;98&gt;</td>
</tr>
<tr>
<td>EEEE</td>
<td>科学计数法</td>
<td>99.99EEEE</td>
<td>121.976</td>
<td></td>
</tr>
<tr>
<td>U</td>
<td>nls_dual_currency</td>
<td>U00999</td>
<td>3040</td>
<td>CAD03040(如果nls_dual_currency设置为CAD)</td>
</tr>
<tr>
<td>V</td>
<td>乘以10n次（n是V之后9的数量）</td>
<td>99999V99</td>
<td>3040</td>
<td>304000</td>
</tr>
<tr>
<td>S</td>
<td>前面加上+或者-</td>
<td>S999999</td>
<td>3040</td>
<td>+3040</td>
</tr>
</tbody></table>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://t.zoukankan.com/zqyanywn-p-6047107.html">to_char 详解 - 走看看 (zoukankan.com)</a></p>
</blockquote>
<h4 id="TO-DATE-X-c2-c3"><a href="#TO-DATE-X-c2-c3" class="headerlink" title="TO_DATE(X[,c2[,c3]])"></a>TO_DATE(X[,c2[,c3]])</h4><p>将字符串X转化为日期型</p>
<p>c2,c3,字符型，参照to_char()</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> to_date(<span class="string">&#x27;199912&#x27;</span>,<span class="string">&#x27;yyyymm&#x27;</span>),</span><br><span class="line">  <span class="number">2</span>  to_date(<span class="string">&#x27;2000.05.20&#x27;</span>,<span class="string">&#x27;yyyy.mm.dd&#x27;</span>),</span><br><span class="line">  <span class="number">3</span>  (<span class="type">date</span> <span class="string">&#x27;2008-12-31&#x27;</span>) XXdate,</span><br><span class="line">  <span class="number">4</span>  to_date(<span class="string">&#x27;2008-12-31 12:31:30&#x27;</span>,<span class="string">&#x27;yyyy-mm-dd hh24:mi:ss&#x27;</span>),</span><br><span class="line">  <span class="number">5</span>  (<span class="type">timestamp</span> <span class="string">&#x27;2008-12-31 12:31:30&#x27;</span>) XXtimestamp</span><br><span class="line">  <span class="number">6</span>  <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line">TO_DATE(<span class="string">&#x27;199912&#x27;</span>,<span class="string">&#x27;YYYYMM&#x27;</span>) TO_DATE(<span class="string">&#x27;2000.05.20&#x27;</span>,<span class="string">&#x27;YYYY.MM. XXDATE TO_DATE(&#x27;</span><span class="number">2008</span><span class="number">-12</span><span class="number">-3112</span>:<span class="number">31</span>:<span class="number">30</span><span class="string">&#x27;,&#x27;</span> XXTIMESTAMP</span><br><span class="line"><span class="comment">-------------------------- ------------------------------ ----------- ------------------------------ --------------------------------------------------------------------------------</span></span><br><span class="line"><span class="number">1999</span><span class="number">-12</span><span class="number">-01</span>      <span class="number">2000</span><span class="number">-05</span><span class="number">-20</span>          <span class="number">2008</span><span class="number">-12</span><span class="number">-31</span> <span class="number">2008</span><span class="number">-12</span><span class="number">-31</span> <span class="number">12</span>:<span class="number">31</span>:<span class="number">30</span> <span class="number">31</span><span class="operator">-</span><span class="type">DEC</span><span class="number">-08</span> <span class="number">12.31</span><span class="number">.30</span><span class="number">.000000000</span> PM</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="3-5-其他函数"><a href="#3-5-其他函数" class="headerlink" title="3.5 其他函数"></a>3.5 其他函数</h3><h4 id="case-when"><a href="#case-when" class="headerlink" title="case when"></a>case when</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--简单Case函数</span></span><br><span class="line"><span class="keyword">CASE</span> sex</span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;2&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;女&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;其他&#x27;</span> <span class="keyword">END</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--Case搜索函数</span></span><br><span class="line"><span class="keyword">CASE</span> <span class="keyword">WHEN</span> sex <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> sex <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;女&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;其他&#x27;</span> <span class="keyword">END</span></span><br></pre></td></tr></table></figure>

<h4 id="nvl-nvl2"><a href="#nvl-nvl2" class="headerlink" title="nvl() nvl2()"></a>nvl() nvl2()</h4><p>为空值赋值。</p>
<p>NVL (expr1, expr2) 【功能】若expr1为NULL，返回expr2；expr1不为NULL，返回expr1。</p>
<p>NVL2 (expr1, expr2, expr3) ,expr1不为NULL，返回expr2；expr2为NULL，返回expr3。</p>
<h4 id="COALESCE"><a href="#COALESCE" class="headerlink" title="COALESCE"></a>COALESCE</h4><p>返回第一个不为空的表达式，如果都为空则返回空值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">coalesce</span>(<span class="keyword">null</span> ,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">------</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="DECODE"><a href="#DECODE" class="headerlink" title="DECODE"></a>DECODE</h4><p>根据条件返回相应值。decode(条件,值1,翻译值1,值2,翻译值2,…值n,翻译值n,缺省值)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> decode(sex,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;其他&#x27;</span>) <span class="keyword">as</span> sex <span class="keyword">from</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure>

<h4 id="listagg"><a href="#listagg" class="headerlink" title="listagg()"></a>listagg()</h4><p>listagg() group (order by ) over(partition by)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">       deptno, <span class="built_in">listagg</span>(ename,<span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> ( <span class="keyword">order</span> <span class="keyword">by</span> deptno,ENAME <span class="keyword">desc</span> ) listagg</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_23-00-07.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 分析函数</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">listagg</span>(ename, <span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> ( <span class="keyword">order</span> <span class="keyword">by</span> ename) <span class="keyword">over</span> ( <span class="keyword">partition</span> <span class="keyword">by</span> DEPTNO) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p> <img data-src="http://cdn.qiyunzhou.top/oracle/202203071556195.png"></p>
<h4 id="pivot"><a href="#pivot" class="headerlink" title="pivot"></a>pivot</h4><p><strong>行转列</strong>函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ....</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span><span class="keyword">table</span><span class="operator">-</span>expr<span class="operator">&gt;</span></span><br><span class="line">   PIVOT</span><br><span class="line">     (</span><br><span class="line">      aggregate<span class="operator">-</span><span class="keyword">function</span>(<span class="operator">&lt;</span><span class="keyword">column</span><span class="operator">&gt;</span>)</span><br><span class="line">      <span class="keyword">FOR</span> <span class="operator">&lt;</span>pivot<span class="operator">-</span><span class="keyword">column</span><span class="operator">&gt;</span> <span class="keyword">IN</span> (<span class="operator">&lt;</span>value1<span class="operator">&gt;</span>, <span class="operator">&lt;</span>value2<span class="operator">&gt;</span>,..., <span class="operator">&lt;</span>valuen<span class="operator">&gt;</span>)</span><br><span class="line">        ) <span class="keyword">AS</span> <span class="operator">&lt;</span>alias<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHERE</span> .....</span><br></pre></td></tr></table></figure>

<p>原始数据</p>
<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203111454703.png"></p>
<p>单列透视<br>查询某个产品在某个渠道销售金额总和情况</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> PRODUCT, <span class="comment">--该列未在pivot中，所以被当作分组条件</span></span><br><span class="line">             CHANNEL,</span><br><span class="line">             AMOUNT_SOLD</span><br><span class="line">      <span class="keyword">from</span> SALES)</span><br><span class="line">    pivot (<span class="built_in">sum</span>(AMOUNT_SOLD) <span class="keyword">as</span> 店 <span class="comment">-- 若不设置，则默认使用in里设置的别名，否则两个别名相加</span></span><br><span class="line">    <span class="keyword">for</span> CHANNEL <span class="keyword">in</span> (<span class="number">3</span> <span class="keyword">as</span> 直营, <span class="number">4</span> <span class="keyword">as</span> 电商, <span class="number">5</span> <span class="keyword">as</span> 自媒体, <span class="number">9</span> <span class="keyword">as</span> 加盟,<span class="number">10</span>));</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203111539167.png"></p>
<p>多列透视<br>查询某个产品在某个渠道和某个季度,销售数量的总和</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> PRODUCT, CHANNEL, QUARTER, AMOUNT_SOLD <span class="keyword">from</span> SALES)</span><br><span class="line">    pivot (<span class="built_in">sum</span>(AMOUNT_SOLD)</span><br><span class="line">    <span class="keyword">for</span> (CHANNEL,QUARTER) <span class="keyword">in</span> ((<span class="number">5</span>, <span class="string">&#x27;03&#x27;</span>) <span class="keyword">AS</span> 自媒体三季度销售量,</span><br><span class="line">        (<span class="number">4</span>, <span class="string">&#x27;02&#x27;</span>) <span class="keyword">AS</span> 电商二季度销售量,</span><br><span class="line">        (<span class="number">3</span>, <span class="string">&#x27;01&#x27;</span>) <span class="keyword">AS</span> 直营店一季度销售量,</span><br><span class="line">        (<span class="number">3</span>, <span class="string">&#x27;02&#x27;</span>) <span class="keyword">AS</span> 直营店二季度销售量,</span><br><span class="line">        (<span class="number">9</span>, <span class="string">&#x27;04&#x27;</span>) <span class="keyword">AS</span> 加盟店四季度销售量));</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203111642240.png"></p>
<p>多个聚合<br>查询某个产品在某个渠道的销售金额总和以及销售数量总和</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> PRODUCT, CHANNEL, AMOUNT_SOLD, QUANTITY_SOLD <span class="keyword">from</span> SALES)</span><br><span class="line">    pivot (<span class="built_in">sum</span>(AMOUNT_SOLD) <span class="keyword">as</span> sas, <span class="built_in">sum</span>(QUANTITY_SOLD) sqs <span class="keyword">for</span> CHANNEL <span class="keyword">in</span> (<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">9</span>))</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> PRODUCT;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203111656497.png"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Milogenius/article/details/103616726">Oracle函数篇 - pivot行转列函数</a></p>
</blockquote>
<p><strong>转动态列</strong></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Huay_Li/article/details/82924443">Oracle 行转列 动态出转换的列_Lhy的博客-CSDN博客_</a></p>
</blockquote>
<h4 id="unpivot"><a href="#unpivot" class="headerlink" title="unpivot"></a>unpivot</h4><p><code>unpivot(新列名 for 聚合列名 in (对应的列名1…列名n ))</code></p>
<p><strong>列转行</strong>，将表中多个列缩减为一个聚合列</p>
<p>原始数据</p>
<p><img data-src="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_22-51-12.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 姓名,科目,成绩</span><br><span class="line"><span class="keyword">from</span> score unpivot ( 成绩 <span class="keyword">for</span> 科目 <span class="keyword">in</span> ( 语文, 数学, 英语 ) );</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_22-51-30.png"></p>
<p>处理空字段 include nulls</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> msg</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    (<span class="keyword">select</span> ename, job, to_char(sal) sal, <span class="keyword">null</span> <span class="keyword">as</span> col <span class="keyword">from</span> emp <span class="keyword">where</span> DEPTNO<span class="operator">=</span><span class="number">10</span>) <span class="comment">-- 要合并的列类型必须相同</span></span><br><span class="line">    unpivot include nulls (msg <span class="keyword">for</span> info <span class="keyword">in</span> (ename,job,sal,col));</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203141046967.png"></p>
<h4 id="group-by、rollup、cube"><a href="#group-by、rollup、cube" class="headerlink" title="group by、rollup、cube"></a>group by、rollup、cube</h4><p><strong>group by</strong></p>
<p>按字段对数据进行分组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,class,item,<span class="built_in">sum</span>(price)</span><br><span class="line"><span class="keyword">from</span> GROUP_BY</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> name, class, item</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> name,class,item;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203081022893.png"></p>
<p><strong>Rollup</strong></p>
<p>ROLLUP，是GROUP BY子句的一种扩展，可以为每个分组返回小计记录以及为所有分组返回总计记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,class,item,<span class="built_in">sum</span>(price),</span><br><span class="line">       <span class="keyword">grouping</span>(name),<span class="keyword">grouping</span>(class),<span class="keyword">grouping</span>(item)</span><br><span class="line"><span class="keyword">from</span> GROUP_BY</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">rollup</span> (name, class, item)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> name,class,item;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203081049796.png"></p>
<p><strong>Cube</strong></p>
<p>CUBE，也是GROUP BY子句的一种扩展，可以返回每一个列组合的小计记录，同时在末尾加上总计记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,class,item,<span class="built_in">sum</span>(price),</span><br><span class="line">       <span class="keyword">grouping</span>(name),<span class="keyword">grouping</span>(class),<span class="keyword">grouping</span>(item)</span><br><span class="line"><span class="keyword">from</span> GROUP_BY</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">cube</span> (name, class, item)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> name,class,item;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203081049968.png"></p>
<p><strong>使用数字表示</strong></p>
<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203081129722.png"></p>
<p><strong>grouping</strong> 处理空值</p>
<p>GROUPING只能在使用ROLLUP或CUBE的查询中使用</p>
<p>列值为空，返回1；列值非空，返回0</p>
<p><strong>两列统计</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">case</span></span><br><span class="line">           <span class="keyword">when</span> <span class="keyword">grouping</span>(name) <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">then</span></span><br><span class="line">               <span class="built_in">count</span>(<span class="keyword">distinct</span> name) <span class="operator">||</span> <span class="string">&#x27;位&#x27;</span></span><br><span class="line">           <span class="keyword">else</span></span><br><span class="line">               name</span><br><span class="line">           <span class="keyword">end</span>    <span class="keyword">as</span> customer,</span><br><span class="line">       <span class="keyword">case</span></span><br><span class="line">           <span class="keyword">when</span> <span class="keyword">grouping</span>(class) <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">grouping</span>(name) <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">               <span class="string">&#x27;合计&#x27;</span></span><br><span class="line">           <span class="keyword">when</span> <span class="keyword">grouping</span>(class) <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">               <span class="string">&#x27;小计&#x27;</span></span><br><span class="line">           <span class="keyword">else</span></span><br><span class="line">               class</span><br><span class="line">           <span class="keyword">end</span>    <span class="keyword">as</span> class,</span><br><span class="line">       <span class="built_in">sum</span>(price) <span class="keyword">as</span> total,</span><br><span class="line">       <span class="keyword">grouping</span>(name),</span><br><span class="line">       <span class="keyword">grouping</span>(class)</span><br><span class="line"><span class="keyword">from</span> group_by</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">rollup</span> (name, class)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> name, class;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203081110551.png"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/springy/p/9375236.html">group by、rollup、cube的用法以及区别 - springy - 博客园 (cnblogs.com)</a></p>
</blockquote>
<h3 id="3-6分析函数"><a href="#3-6分析函数" class="headerlink" title="3.6分析函数"></a>3.6分析函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function_name(<span class="operator">&lt;</span>argument<span class="operator">&gt;</span>,<span class="operator">&lt;</span>argument<span class="operator">&gt;</span>...) <span class="keyword">over</span>(<span class="operator">&lt;</span>partition_Clause<span class="operator">&gt;</span><span class="operator">&lt;</span><span class="keyword">order</span> by_Clause<span class="operator">&gt;</span><span class="operator">&lt;</span>windowing_Clause<span class="operator">&gt;</span>);</span><br></pre></td></tr></table></figure>

<p>function_name()：函数名称</p>
<p>argument：参数</p>
<p>over( )：开窗函数</p>
<p>partition_Clause：分区子句，数据记录集分组，group by…</p>
<p>order by_Clause：排序子句，数据记录集排序，order by…</p>
<p>windowing_Clause：开窗子句，定义分析函数在操作行的集合，三种开窗方式：rows、range、Specifying</p>
<p><font color='red'>注：</font>使用开窗子句时一定要有排序子句</p>
<h4 id="SUM-OVER"><a href="#SUM-OVER" class="headerlink" title="SUM() OVER()"></a>SUM() OVER()</h4><p> 统计分区中记录的总和</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,ename,sal,</span><br><span class="line">       <span class="built_in">sum</span>(sal) <span class="keyword">over</span> () 总和,</span><br><span class="line">       <span class="built_in">sum</span>(sal) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> deptno,sal) 连续求和,</span><br><span class="line">       <span class="built_in">sum</span>(sal) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptno) 分组总和,</span><br><span class="line">       <span class="built_in">sum</span>(sal) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptno <span class="keyword">order</span> <span class="keyword">by</span> sal) 组内连续求和</span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071551617.png"></p>
<h4 id="rows-between"><a href="#rows-between" class="headerlink" title="rows between"></a>rows between</h4><ul>
<li>UNBOUNDED ：不受控的，无限的；</li>
<li>PRECEDING ： 在…之前；</li>
<li>FOLLOWING： 在…之后；</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rows</span> <span class="keyword">between</span> …… <span class="keyword">and</span> ……</span><br><span class="line"></span><br><span class="line">unbounded preceding 前面所有行</span><br><span class="line">unbounded following 后面所有行</span><br><span class="line"><span class="keyword">current</span> <span class="type">row</span> 当前行</span><br><span class="line">n following  后面n行</span><br><span class="line">n preceding  前面n行</span><br></pre></td></tr></table></figure>

<p>demo</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 前面所有行与当前行的累加（分区内）</span></span><br><span class="line"><span class="built_in">sum</span>(sales_volume) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> id <span class="keyword">rows</span> <span class="keyword">between</span> <span class="keyword">current</span> <span class="type">row</span> <span class="keyword">and</span> unbounded following) sum_sales</span><br><span class="line"><span class="comment">-- 前面所有行与当前行的累加（分区内）</span></span><br><span class="line"><span class="built_in">sum</span>(sales_volume) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> id <span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span>) sum_sales</span><br><span class="line"><span class="comment">-- 当前行与后两行的累加（分区内）</span></span><br><span class="line"><span class="built_in">sum</span>(sales_volume) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> id <span class="keyword">rows</span> <span class="keyword">between</span> <span class="keyword">current</span> <span class="type">row</span> <span class="keyword">and</span> <span class="number">2</span> following) sum_sales</span><br><span class="line"><span class="comment">-- 前一行与当前行的累加（分区内）</span></span><br><span class="line"><span class="built_in">sum</span>(sales_volume) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> id <span class="keyword">rows</span> <span class="keyword">between</span> <span class="number">1</span> preceding <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span>) sum_sales</span><br><span class="line"><span class="comment">-- 前一行的值+当前行的值+后一行的值</span></span><br><span class="line"><span class="built_in">sum</span>(id) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> category <span class="keyword">rows</span> <span class="keyword">between</span> <span class="number">1</span> preceding <span class="keyword">and</span> <span class="number">1</span> following) rank <span class="keyword">from</span> t</span><br></pre></td></tr></table></figure>

<h4 id="range-between"><a href="#range-between" class="headerlink" title="range between"></a>range between</h4><p>按照列值限制窗口大小（在非条件表达式中等同于rows）</p>
<p>range between是以当前值为锚点进行计算</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 如果当前值为10的话就取前后的值在6到17之间的数据</span></span><br><span class="line"><span class="keyword">range</span> <span class="keyword">between</span> <span class="number">4</span> preceding <span class="keyword">AND</span> <span class="number">7</span> following</span><br><span class="line"><span class="comment">-- 分区内第一行和最后一行,在非条件表达式中等同于ROWS</span></span><br><span class="line"><span class="built_in">SUM</span>(salary) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> dept_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date <span class="keyword">RANGE</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING  <span class="keyword">AND</span> UNBOUNDED FOLLOWING)</span><br><span class="line"><span class="comment">-- 分区的第一行和本行，在非条件表达式中等同于ROWS</span></span><br><span class="line"><span class="built_in">SUM</span>(salary) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> dept_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date <span class="keyword">RANGE</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="keyword">AND</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span>) </span><br><span class="line"><span class="comment">-- 该分区内小于本记录hire_date-365天的所有的薪资累计</span></span><br><span class="line"><span class="built_in">SUM</span>(salary) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> dept_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> hire_date <span class="keyword">RANGE</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="keyword">AND</span> <span class="number">365</span><span class="comment">/*value_expr*/</span> PRECEDING)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>对于日期range开窗，默认单位是天，可以用<strong>interval</strong>来写明间隔单位</p>
<p><code>order by range between interval &#39;3&#39; month preceding and current row</code></p>
<p><font color='red'>注意：</font></p>
<p>ROWS：是按物理行来进行窗口级别里再次进行范围选择的<br>RANGE：是按逻辑行来进行窗口级别里再次进行范围选择的。RANGE时，相同行会被合并成同一条数据再进行计算，相同行窗口计算时的结果也是相同的<br>是否是相同行，是根据ORDER BY排序时的结果决定的。<br>有ORDER BY时：同行是说在ORDER BY排序时不唯一的行，<strong>即具有相同数值的行</strong>。 不同行是说ORDER BY排序时具有不同的数值的行。<br>没有ORDER BY：那么就是当前分区的所有行都包含在框架中，因为所有行都会成为当前行的相同行</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42374697/article/details/115109386?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.pc_relevant_default&spm=1001.2101.3001.4242.1&utm_relevant_index=3">窗口函数rows between 、range between的使用</a></p>
</blockquote>
<h4 id="COUNT-OVER"><a href="#COUNT-OVER" class="headerlink" title="COUNT() OVER()"></a>COUNT() OVER()</h4><p> 统计分区中各组的行数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,deptno,</span><br><span class="line">       <span class="built_in">count</span>(empno) <span class="keyword">over</span> () 总和,</span><br><span class="line">       <span class="built_in">count</span>(empno) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> deptno,empno) 连续求和,</span><br><span class="line">       <span class="built_in">count</span>(empno) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptno) 分组总和,</span><br><span class="line">       <span class="built_in">count</span>(empno) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptno <span class="keyword">order</span> <span class="keyword">by</span> empno) 组内连续求和</span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071552268.png"></p>
<h4 id="avg-over"><a href="#avg-over" class="headerlink" title="avg() over()"></a>avg() over()</h4><p>统计分区中记录的平均值，partition by 可选，order by 可选</p>
<h4 id="min-over"><a href="#min-over" class="headerlink" title="min() over()"></a>min() over()</h4><p>统计分区中记录的最小值，partition by 可选，order by 可选</p>
<h4 id="max-over"><a href="#max-over" class="headerlink" title="max() over()"></a>max() over()</h4><p>统计分区中记录的最大值，partition by 可选，order by 可选</p>
<h4 id="rank-over"><a href="#rank-over" class="headerlink" title="rank() over()"></a>rank() over()</h4><p>跳跃排序</p>
<h4 id="dense-rank"><a href="#dense-rank" class="headerlink" title="dense_rank()"></a>dense_rank()</h4><p>连续排序</p>
<h4 id="row-number-over"><a href="#row-number-over" class="headerlink" title="row_number() over()"></a>row_number() over()</h4><p>排序，无重复值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t.<span class="operator">*</span>,</span><br><span class="line">       <span class="built_in">rank</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> col2 <span class="keyword">order</span> <span class="keyword">by</span> col1) rank,</span><br><span class="line">       <span class="built_in">dense_rank</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> col2 <span class="keyword">order</span> <span class="keyword">by</span> col1) dense_rank,</span><br><span class="line">       <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> col2 <span class="keyword">order</span> <span class="keyword">by</span> col1) num</span><br><span class="line"><span class="keyword">from</span> XGJ t;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071552858.png"></p>
<p><font color='red'>注：</font> rank和 dense_rank 主要的功能是计算一组数值中的排序值。<br>        dence_rank在并列关系是，相关等级不会跳过。rank则跳过.<br>        rank()是跳跃排序，有两个第二名时接下来就是第四名（同样是在各个分组内）<br>        dense_rank()l是连续排序，有两个第二名时仍然跟着第三名。</p>
<h4 id="ntile-n-over"><a href="#ntile-n-over" class="headerlink" title="ntile(n) over()"></a>ntile(n) over()</h4><p>partition by 可选，order by 必选</p>
<p> n表示将分区内记录平均分成n份，多出的按照顺序依次分给前面的组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,deptno,sal,</span><br><span class="line">       <span class="built_in">ntile</span>(<span class="number">5</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) 均分,</span><br><span class="line">       <span class="built_in">ntile</span>(<span class="number">3</span>) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptno <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) 按组均分</span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071552858.png"></p>
<h4 id="first-value-over"><a href="#first-value-over" class="headerlink" title="first_value() over()"></a>first_value() over()</h4><p>取出分区中第一条记录的字段值，partition by 可选，order by 可选</p>
<h4 id="last-value-over"><a href="#last-value-over" class="headerlink" title="last_value() over()"></a>last_value() over()</h4><p>取出分区中最后一条记录的字段值，partition by 可选，order by 可选</p>
<h4 id="lag-over"><a href="#lag-over" class="headerlink" title="lag() over()"></a>lag() over()</h4><p>取出前n行数据，partition by 可选，order by 必选</p>
<h4 id="lead-over"><a href="#lead-over" class="headerlink" title="lead() over()"></a>lead() over()</h4><p>取出后n行数据，partition by 可选，order by 必选</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">lag</span>(EXPR,<span class="operator">&lt;</span><span class="keyword">OFFSET</span><span class="operator">&gt;</span>,<span class="operator">&lt;</span><span class="keyword">DEFAULT</span><span class="operator">&gt;</span>)</span><br><span class="line"><span class="built_in">LEAD</span>(EXPR,<span class="operator">&lt;</span><span class="keyword">OFFSET</span><span class="operator">&gt;</span>,<span class="operator">&lt;</span><span class="keyword">DEFAULT</span><span class="operator">&gt;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>EXPR是从其他行返回的表达式</li>
<li>OFFSET是缺省为1 的正数，表示相对行数。希望检索的当前行分区的偏移量</li>
<li>DEFAULT是在OFFSET表示的数目超出了分组的范围时返回的值。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,ename,sal,</span><br><span class="line">       <span class="built_in">lag</span>(ename, <span class="number">1</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> sal)    next_ename,</span><br><span class="line">       <span class="built_in">lag</span>(ename, <span class="number">2</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> sal)    next_ename2,</span><br><span class="line">       <span class="built_in">lag</span>(ename, <span class="number">1</span>, <span class="number">0</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> sal) next_ename10,</span><br><span class="line">       <span class="built_in">lag</span>(ename, <span class="number">1</span>, <span class="number">1</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> sal) next_ename11,</span><br><span class="line">       <span class="built_in">lag</span>(ename, <span class="number">2</span>, <span class="number">0</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> sal) next_ename20</span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071554902.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t.<span class="operator">*</span>,</span><br><span class="line">       <span class="built_in">lag</span>(stepid) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> caseid <span class="keyword">order</span> <span class="keyword">by</span> stepid) next_id,</span><br><span class="line">       <span class="built_in">lag</span>(actiondate) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> caseid <span class="keyword">order</span> <span class="keyword">by</span> stepid) next_date</span><br><span class="line"><span class="keyword">from</span> LEAD_TABLE t;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071555145.png"></p>
<h4 id="ratio-to-report-over"><a href="#ratio-to-report-over" class="headerlink" title="ratio_to_report() over()"></a>ratio_to_report() over()</h4><p>ratio_to_report(a) over(partition by b) </p>
<p>按照b分组后a的值在所属分组中总值的占比,a的值必须为数值或数值型字段</p>
<p>partition by 可选，order by 不可选</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,ename,job,sal,</span><br><span class="line">       ratio_to_report(<span class="number">1</span>) <span class="keyword">over</span> () 行数比例, <span class="comment">--给每一行赋值1，求当前行在总值的占比</span></span><br><span class="line">       ratio_to_report(sal) <span class="keyword">over</span> () 工资比列, <span class="comment">--当前行的值在所有数据中的占比</span></span><br><span class="line">       ratio_to_report(<span class="number">1</span>) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptno) 分组行数比例, <span class="comment">--给每一行赋值1，求当前行在分组后的组内总值的占比 </span></span><br><span class="line">       ratio_to_report(sal) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptno) 分组工资比例 <span class="comment">--当前行的值在分组后组内总值占比</span></span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>percent_rank() over()  ：partition by 可选，order by 必选</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,ename,job,sal,</span><br><span class="line">       <span class="built_in">percent_rank</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> ename)</span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071555810.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,ename,job,sal,</span><br><span class="line">       <span class="built_in">percent_rank</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> deptno <span class="keyword">order</span> <span class="keyword">by</span> sal) <span class="keyword">percent</span></span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071555829.png"></p>
<h4 id="MAX-KEEP"><a href="#MAX-KEEP" class="headerlink" title="MAX()   KEEP()"></a>MAX()   KEEP()</h4><p>MAX()   KEEP(DENSE_RANK FIRST/LAST)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 获取部门内年龄最小的人中，工资最高的记录</span></span><br><span class="line"><span class="keyword">select</span> dept,<span class="built_in">max</span>(sal) keep ( dense_rank <span class="keyword">first</span> <span class="keyword">order</span> <span class="keyword">by</span> age) <span class="keyword">from</span> keep <span class="keyword">group</span> <span class="keyword">by</span> dept;</span><br><span class="line"><span class="keyword">select</span> dept,<span class="built_in">max</span>(sal) keep ( dense_rank <span class="keyword">last</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>) <span class="keyword">from</span> keep <span class="keyword">group</span> <span class="keyword">by</span> dept;</span><br><span class="line"><span class="comment">-- 获取部门内年龄最小的人中，工资最低的记录</span></span><br><span class="line"><span class="keyword">select</span> dept,<span class="built_in">min</span>(sal) keep ( dense_rank <span class="keyword">first</span> <span class="keyword">order</span> <span class="keyword">by</span> age) <span class="keyword">from</span> keep <span class="keyword">group</span> <span class="keyword">by</span> dept;</span><br><span class="line"><span class="comment">-- 年龄最大人中的最低工资查询</span></span><br><span class="line"><span class="keyword">select</span> dept,<span class="built_in">min</span>(sal) keep ( dense_rank <span class="keyword">first</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span> ) <span class="keyword">from</span> keep <span class="keyword">group</span> <span class="keyword">by</span> dept;</span><br><span class="line"><span class="keyword">select</span> dept,<span class="built_in">min</span>(sal) keep ( dense_rank <span class="keyword">last</span> <span class="keyword">order</span> <span class="keyword">by</span> age ) <span class="keyword">from</span> keep <span class="keyword">group</span> <span class="keyword">by</span> dept;</span><br></pre></td></tr></table></figure>

<p>KEEP</p>
<p>keep的意思就是“保持”，会保持满足括号内条件的记录，用ORDER BY 后自然会有FIRST和LAST了。</p>
<p>DENSE_RANK</p>
<p>DENSE_RANK是排序策略。例如，它会将两个第二名排在第一名之后，之后还是第三名排在第二名之后。</p>
<p>FIRST/LAST</p>
<p>FIRST/LAST就是对数据进行筛选</p>
<p>listagg() within group(order by )</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">       deptno <span class="operator">||</span><span class="string">&#x27;    &#x27;</span><span class="operator">||</span> <span class="built_in">listagg</span>(ename,<span class="string">&#x27;,&#x27;</span>) listagg1,</span><br><span class="line">       deptno <span class="operator">||</span><span class="string">&#x27;    &#x27;</span><span class="operator">||</span> <span class="built_in">listagg</span>(ename,<span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> ( <span class="keyword">order</span> <span class="keyword">by</span> deptno,ENAME <span class="keyword">desc</span> ) listagg2</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203071555784.png"></p>
<h3 id="3-7-树状结构层级查询"><a href="#3-7-树状结构层级查询" class="headerlink" title="3.7 树状结构层级查询"></a>3.7 树状结构层级查询</h3><h4 id="简单树状查询"><a href="#简单树状查询" class="headerlink" title="简单树状查询"></a>简单树状查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [LEVEL],<span class="operator">*</span></span><br><span class="line">　　FEOM table_name </span><br><span class="line">　　<span class="keyword">WHERE</span> 条件<span class="number">1</span></span><br><span class="line">　　<span class="keyword">START</span> <span class="keyword">WITH</span> 条件<span class="number">2</span></span><br><span class="line">　　<span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR 条件<span class="number">3</span></span><br><span class="line">　　<span class="keyword">ORDER</span>　<span class="keyword">BY</span>　排序字段</span><br><span class="line">说明：LEVEL<span class="comment">---伪列，用于表示树的层次</span></span><br><span class="line">	  PRIOR<span class="comment">---上一级的信息</span></span><br><span class="line">	 条件<span class="number">1</span><span class="comment">---过滤条件，对所有返回的记录进行过滤。</span></span><br><span class="line">　　　条件<span class="number">2</span><span class="comment">---根节点的限定条件，当然也可以放宽权限，以获得多个根节点，也就是获取多个树</span></span><br><span class="line">　　　条件<span class="number">3</span><span class="comment">---连接条件，目的就是给出父子之间的关系是什么，根据这个关系进行递归查询</span></span><br><span class="line">　　　</span><br><span class="line">　　　排序字段<span class="comment">---对所有返回记录进行排序</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename,mgr,(prior ename) <span class="keyword">as</span> prior_name</span><br><span class="line"><span class="keyword">from</span> EMP</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> EMPNO <span class="operator">=</span> <span class="number">7839</span></span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> (prior EMPNO) <span class="operator">=</span> mgr</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> level;</span><br></pre></td></tr></table></figure>

<h4 id="根节点、分支节点、叶子节点"><a href="#根节点、分支节点、叶子节点" class="headerlink" title="根节点、分支节点、叶子节点"></a>根节点、分支节点、叶子节点</h4><p><code>level</code>返回当前行所在的等级，根节点level为1，下级为2…<br>如果当前节点下有其他节点，则<code>connect_by_isleaf</code>返回0，否则返回1<br><code>connect_by_root</code> 返回当前节点的最顶端节点<br><code>sys_connect_by_path</code>函数显示详细路径，<code>sys_connect_by_path(column_name,&#39;connect_symbol&#39;)</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> lpad(<span class="string">&#x27;-&#x27;</span>, (level<span class="number">-1</span>)<span class="operator">*</span><span class="number">2</span>,<span class="string">&#x27;-&#x27;</span>) <span class="operator">||</span> EMPNO <span class="keyword">as</span> 员工编码,</span><br><span class="line">       ename,mgr,level,</span><br><span class="line">       connect_by_root empno 根节点_no,</span><br><span class="line">       decode(level,<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">as</span> 根节点,</span><br><span class="line">       decode(connect_by_isleaf,<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">as</span> 分支节点,</span><br><span class="line">       <span class="keyword">case</span> <span class="keyword">when</span> (connect_by_isleaf <span class="operator">=</span> <span class="number">0</span> <span class="keyword">and</span> level <span class="operator">&gt;</span> <span class="number">1</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">end</span> <span class="keyword">as</span> 叶子节点,</span><br><span class="line">       SYS_CONNECT_BY_PATH(empno, <span class="string">&#x27;/&#x27;</span>) <span class="keyword">as</span> 节点路径</span><br><span class="line"><span class="keyword">from</span> EMP</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> EMPNO <span class="operator">=</span> <span class="number">7839</span></span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> (prior EMPNO) <span class="operator">=</span> mgr;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203141642756.png"></p>
<h4 id="树形查询中的排序"><a href="#树形查询中的排序" class="headerlink" title="树形查询中的排序"></a>树形查询中的排序</h4><p>对应树形查询，应该只针对同一分支下的数据进行排序，使用 <code>order siblings by</code>关键字</p>
<h2 id="4-常用操作"><a href="#4-常用操作" class="headerlink" title="4. 常用操作"></a>4. 常用操作</h2><h3 id="4-1-拼接列"><a href="#4-1-拼接列" class="headerlink" title="4.1 拼接列"></a>4.1 拼接列</h3><p>可以用字符串连接符“||”将各列拼接起来</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ENAME <span class="operator">||</span> <span class="string">&#x27;工作是&#x27;</span> <span class="operator">||</span> job MSG <span class="keyword">from</span> EMP <span class="keyword">where</span> DEPTNO <span class="operator">=</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-限制返回的行数"><a href="#4-2-限制返回的行数" class="headerlink" title="4.2 限制返回的行数"></a>4.2 限制返回的行数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> rownum sn, t.<span class="operator">*</span> <span class="keyword">from</span> emp t <span class="keyword">where</span> rownum <span class="operator">&lt;=</span> <span class="number">2</span>)</span><br><span class="line"><span class="keyword">where</span> sn <span class="operator">&lt;=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-随机返回n条记录"><a href="#4-3-随机返回n条记录" class="headerlink" title="4.3 随机返回n条记录"></a>4.3 随机返回n条记录</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> EMPNO, ENAME <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> dbms_random.value())</span><br><span class="line"><span class="keyword">where</span> rownum <span class="operator">&lt;=</span> <span class="number">3</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>ORDER BY 1 表示以select 的字段按第一个字段排序</li>
</ul>
<h3 id="4-4-排序"><a href="#4-4-排序" class="headerlink" title="4.4 排序"></a>4.4 排序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ordery <span class="keyword">by</span> <span class="number">1</span>; <span class="comment">-- 按照第一列排序</span></span><br><span class="line">nulls <span class="keyword">first</span> <span class="comment">-- 空值在前</span></span><br><span class="line">nulls <span class="keyword">last</span> <span class="comment">-- 空值在后</span></span><br></pre></td></tr></table></figure>

<h3 id="4-5-in、exists"><a href="#4-5-in、exists" class="headerlink" title="4.5 in、exists"></a>4.5 in、exists</h3><p>如果子查询得出的结果集记录较少，主查询中的表较大且又有索引时应该用in, 反之如果外层的主查询记录较少，子查询中的表大，又有索引时使用exists</p>
<h3 id="4-6-行行比较"><a href="#4-6-行行比较" class="headerlink" title="4.6 行行比较"></a>4.6 行行比较</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> EMPNO,ENAME,JOB,DEPTNO <span class="keyword">from</span> EMP <span class="keyword">where</span> (ename, JOB, SAL) <span class="keyword">in</span> (<span class="keyword">select</span> ENAME,JOB, SAL <span class="keyword">from</span> emp2);</span><br></pre></td></tr></table></figure>

<h3 id="4-7-插入、更新与删除"><a href="#4-7-插入、更新与删除" class="headerlink" title="4.7 插入、更新与删除"></a>4.7 插入、更新与删除</h3><p>复制表的定义与数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 复制表结构及数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 复制表结构</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test <span class="keyword">where</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p><font color='red'>复制的表不包含索引、默认值等约束信息</font></p>
<h3 id="4-8-WITH-CHECK-OPTION"><a href="#4-8-WITH-CHECK-OPTION" class="headerlink" title="4.8 WITH  CHECK  OPTION"></a>4.8 WITH  CHECK  OPTION</h3><p>限制数据录入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> ch_sal <span class="keyword">check</span> ( sal <span class="operator">&gt;</span> <span class="number">0</span>  );</span><br><span class="line"><span class="comment">-- 有些复杂条件不能使用</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> ch_hiredate <span class="keyword">check</span> ( hiredate <span class="operator">&gt;</span> sysdate );</span><br><span class="line"><span class="comment">-- ORA-02436: 日期或系统变量在 CHECK 约束条件中指定错误</span></span><br></pre></td></tr></table></figure>

<h3 id="4-9-多表插入"><a href="#4-9-多表插入" class="headerlink" title="4.9 多表插入"></a>4.9 多表插入</h3><h4 id="INSERT-ALL"><a href="#INSERT-ALL" class="headerlink" title="INSERT ALL"></a>INSERT ALL</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 无条件</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">into</span> emp1(empno, ename, job) <span class="keyword">values</span> (empno, ename, job)</span><br><span class="line">    <span class="keyword">into</span> emp2(empno, ename, deptno) <span class="keyword">values</span> (empno, ename, deptno)</span><br><span class="line">    <span class="keyword">select</span> empno, ename, job, deptno <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="keyword">in</span> (<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line"><span class="comment">-- 有条件</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">when</span> job <span class="keyword">in</span> (<span class="string">&#x27;job1&#x27;</span>, <span class="string">&#x27;job2&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">into</span> emp1(empno, ename, job) <span class="keyword">values</span> (empno, ename ,job)</span><br><span class="line">    <span class="keyword">when</span> deptno <span class="keyword">in</span> (<span class="number">10</span>, <span class="number">20</span>) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">into</span> emp2(empno, ename, deptno) <span class="keyword">values</span> (empno, ename, deptno)</span><br><span class="line">    <span class="keyword">select</span> empno, ename, job, deptno <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h4 id="INSERT-FIRST"><a href="#INSERT-FIRST" class="headerlink" title="INSERT FIRST"></a>INSERT FIRST</h4><p>当第一个表符合条件后，第二个表将不再插入对应的行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">first</span></span><br><span class="line">    <span class="keyword">when</span> job <span class="keyword">in</span> (<span class="string">&#x27;job1&#x27;</span>, <span class="string">&#x27;job2&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">into</span> emp1(empno, ename, job) <span class="keyword">values</span> (empno, ename ,job)</span><br><span class="line">    <span class="keyword">when</span> deptno <span class="keyword">in</span> (<span class="number">10</span>, <span class="number">20</span>) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">into</span> emp2(empno, ename, deptno) <span class="keyword">values</span> (empno, ename, deptno)</span><br><span class="line">    <span class="keyword">select</span> empno, ename, job, deptno <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h3 id="4-10-MERGE-INTO"><a href="#4-10-MERGE-INTO" class="headerlink" title="4.10 MERGE INTO"></a>4.10 MERGE INTO</h3><p>判断表中有没有符合on（）条件中的数据，有了就更新数据，没有就插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">MERGE</span> <span class="keyword">INTO</span> table_name a</span><br><span class="line"><span class="keyword">USING</span> (<span class="keyword">table</span> <span class="operator">|</span> <span class="keyword">view</span> <span class="operator">|</span> sub_query) b</span><br><span class="line"><span class="keyword">ON</span> (<span class="keyword">join</span> <span class="keyword">condition</span>)</span><br><span class="line"><span class="keyword">WHEN</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">  UPDATE table_name <span class="keyword">SET</span> col1 <span class="operator">=</span> col_val1, col2 <span class="operator">=</span> col2_val</span><br><span class="line"><span class="keyword">WHEN</span> <span class="keyword">NOT</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">  <span class="keyword">INSERT</span> (column_list) <span class="keyword">VALUES</span> (column_values);</span><br></pre></td></tr></table></figure>

<h3 id="4-11-范围处理"><a href="#4-11-范围处理" class="headerlink" title="4.11 范围处理"></a>4.11 范围处理</h3><h4 id="定位连续值范围的开始点和结束点"><a href="#定位连续值范围的开始点和结束点" class="headerlink" title="定位连续值范围的开始点和结束点"></a>定位连续值范围的开始点和结束点</h4><p>原始数据</p>
<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203101630060.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">    <span class="comment">-- 获取上一期的结束时间</span></span><br><span class="line">    <span class="keyword">select</span> id,<span class="keyword">begin</span>,<span class="keyword">end</span>,</span><br><span class="line">        <span class="built_in">lag</span>(<span class="keyword">end</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> id) <span class="keyword">as</span> last_end</span><br><span class="line">    <span class="keyword">from</span> v</span><br><span class="line">),</span><br><span class="line">    t1 <span class="keyword">as</span> (</span><br><span class="line">        <span class="comment">-- 标定连续状态</span></span><br><span class="line">        <span class="keyword">select</span> t.<span class="operator">*</span>,</span><br><span class="line">                <span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">begin</span> <span class="operator">=</span> last_end <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">end</span> <span class="keyword">as</span> 连续状态</span><br><span class="line">        <span class="keyword">from</span> t</span><br><span class="line">    ),</span><br><span class="line">     t2 <span class="keyword">as</span> (</span><br><span class="line">         <span class="comment">-- 对状态进行累计，得到分组依据</span></span><br><span class="line">         <span class="keyword">select</span> t1.<span class="operator">*</span>,</span><br><span class="line">                <span class="built_in">sum</span>(连续状态) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> id) <span class="keyword">as</span> 分组依据</span><br><span class="line">         <span class="keyword">from</span> t1</span><br><span class="line">     )</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(<span class="keyword">begin</span>) <span class="keyword">begin</span>, <span class="built_in">max</span>(<span class="keyword">end</span>) <span class="keyword">end</span>,分组依据 <span class="keyword">from</span> t2 <span class="keyword">group</span> <span class="keyword">by</span> 分组依据 <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203101626197.png"></p>
<h4 id="合并时间段"><a href="#合并时间段" class="headerlink" title="合并时间段"></a>合并时间段</h4><p>原始数据</p>
<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203111006937.png"></p>
<p>对于7，8，9行的数据，第8行是不连续的，使用lag（）判断肯定不对，可以使用<code>rows/range between ... preceding and ... following/preceding</code>，获取当前行之前的最大end日期</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t1 <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span> t.<span class="operator">*</span>,</span><br><span class="line">       <span class="built_in">max</span>(<span class="keyword">end</span>) <span class="keyword">over</span> ( <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">begin</span> <span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding <span class="keyword">and</span> <span class="number">1</span> preceding ) <span class="keyword">as</span> max_end</span><br><span class="line">    <span class="keyword">from</span> time_sheets t</span><br><span class="line">),</span><br><span class="line">     t2 <span class="keyword">as</span> (</span><br><span class="line">         <span class="keyword">select</span> t1.begin,t1.end,max_end,</span><br><span class="line">                <span class="keyword">case</span> <span class="keyword">when</span> max_end <span class="operator">&gt;=</span> t1.begin <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">end</span> <span class="keyword">as</span> 连续状态</span><br><span class="line">         <span class="keyword">from</span> t1</span><br><span class="line">     ),</span><br><span class="line">     t3 <span class="keyword">as</span> (</span><br><span class="line">         <span class="keyword">select</span> t2.<span class="operator">*</span>,</span><br><span class="line">                <span class="built_in">sum</span>(连续状态) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">begin</span>) 分组依据</span><br><span class="line">         <span class="keyword">from</span> t2</span><br><span class="line">     )</span><br><span class="line"><span class="keyword">select</span> t3.分组依据, <span class="built_in">min</span>(<span class="keyword">begin</span>) 开始时间, <span class="built_in">max</span>(<span class="keyword">end</span>) <span class="keyword">as</span> 结束时间 <span class="keyword">from</span> t3 <span class="keyword">group</span> <span class="keyword">by</span> 分组依据 <span class="keyword">order</span> <span class="keyword">by</span> t3.分组依据;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203111010541.png"></p>
<h2 id="5-高级查询"><a href="#5-高级查询" class="headerlink" title="5. 高级查询"></a>5. 高级查询</h2><h3 id="5-1-结果集分页"><a href="#5-1-结果集分页" class="headerlink" title="5.1 结果集分页"></a>5.1 结果集分页</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 3.根据前面生成的序号过滤掉6行以前的数据</span></span><br><span class="line"><span class="keyword">select</span> rn <span class="keyword">as</span> 序号, ename, sal <span class="keyword">from</span> (</span><br><span class="line">        <span class="comment">-- 2.取得排序后的序号，并过滤掉10行以后的数据</span></span><br><span class="line">        <span class="keyword">select</span> ROWNUM <span class="keyword">as</span> rn, sal,ename <span class="keyword">from</span> (</span><br><span class="line">            <span class="comment">-- 1.按sal排序</span></span><br><span class="line">            <span class="keyword">select</span> sal,ename <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">order</span> <span class="keyword">by</span> sal</span><br><span class="line">    ) t <span class="keyword">where</span> ROWNUM <span class="operator">&lt;=</span><span class="number">10</span></span><br><span class="line">) t2 <span class="keyword">where</span> t2.rn <span class="operator">&gt;=</span> <span class="number">6</span>;</span><br></pre></td></tr></table></figure>

<p>rownum是一个伪列，需要取出数据后才有值。在执行”where rownum &gt;= 6”时，前10条数据还没取出来</p>
<h3 id="5-2-跳过表中n行"><a href="#5-2-跳过表中n行" class="headerlink" title="5.2 跳过表中n行"></a>5.2 跳过表中n行</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t2.<span class="operator">*</span>, <span class="built_in">mod</span>(t2.rn, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> ROWNUM rn, t.<span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> empno, ename, sal <span class="keyword">from</span> emp) t) t2</span><br><span class="line"><span class="keyword">where</span> <span class="built_in">mod</span>(t2.rn, <span class="number">2</span>) <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-排列组合去重"><a href="#5-3-排列组合去重" class="headerlink" title="5.3 排列组合去重"></a>5.3 排列组合去重</h3><p>原始数据<br>去除t1,t2,t3组合重复的数据</p>
<p><img data-src="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_23-18-25.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> temp <span class="keyword">as</span> (</span><br><span class="line">    <span class="comment">-- 使用unpivot列转行</span></span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test unpivot (b2 <span class="keyword">for</span> b3 <span class="keyword">in</span> (t1,t2,t3))</span><br><span class="line">),</span><br><span class="line">temp2 <span class="keyword">as</span> (</span><br><span class="line">    <span class="comment">-- listagg对各字符排序并合并</span></span><br><span class="line">    <span class="keyword">select</span> id,<span class="built_in">listagg</span>(b2,<span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> ( <span class="keyword">order</span> <span class="keyword">by</span> b2) b <span class="keyword">from</span> temp <span class="keyword">group</span> <span class="keyword">by</span> temp.id</span><br><span class="line">) <span class="keyword">select</span> id,b,<span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> b <span class="keyword">order</span> <span class="keyword">by</span> id) <span class="keyword">as</span> sn <span class="keyword">from</span> temp2;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/Snipaste_2022-03-10_23-26-23.png"></p>
<h3 id="5-4-抑制结果集中的重复值"><a href="#5-4-抑制结果集中的重复值" class="headerlink" title="5.4 抑制结果集中的重复值"></a>5.4 抑制结果集中的重复值</h3><p>返回的结果集中有重复值，要求合并显示，需要在返回时只返回第一行的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">case</span></span><br><span class="line">    <span class="keyword">when</span> <span class="built_in">lag</span>(job) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> job,ename) <span class="operator">=</span> job <span class="keyword">then</span> <span class="keyword">null</span> <span class="keyword">else</span> job <span class="keyword">end</span> <span class="keyword">as</span> 职位,</span><br><span class="line">    ename <span class="keyword">as</span> 姓名</span><br><span class="line"><span class="keyword">from</span> EMP</span><br><span class="line"><span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> emp.job,ename;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203141100640.png"></p>
<h3 id="5-5-给数据分组"><a href="#5-5-给数据分组" class="headerlink" title="5.5 给数据分组"></a>5.5 给数据分组</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t1 <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span> ename <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> ename</span><br><span class="line">),</span><br><span class="line">     t2 <span class="keyword">as</span> ( <span class="comment">-- 生成序号</span></span><br><span class="line">         <span class="keyword">select</span> ROWNUM rn,t1.ename <span class="keyword">from</span> t1</span><br><span class="line">     ),</span><br><span class="line">    t3 <span class="keyword">as</span> ( <span class="comment">-- 通过ceil分组</span></span><br><span class="line">        <span class="keyword">select</span> <span class="built_in">ceil</span>(t2.rn<span class="operator">/</span><span class="number">5</span>)<span class="keyword">as</span> gp,ename <span class="keyword">from</span> t2</span><br><span class="line">    ),</span><br><span class="line">     t4 <span class="keyword">as</span> ( <span class="comment">-- 给各组数据生成序号</span></span><br><span class="line">         <span class="keyword">select</span> gp,ename,<span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> gp <span class="keyword">order</span> <span class="keyword">by</span> ename) <span class="keyword">as</span> rn <span class="keyword">from</span> t3</span><br><span class="line">     ),</span><br><span class="line">     t5 <span class="keyword">as</span> ( <span class="comment">-- 行转列</span></span><br><span class="line">         <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t4 pivot (<span class="built_in">max</span>(ename) <span class="keyword">for</span> rn <span class="keyword">in</span> ( <span class="number">1</span> <span class="keyword">as</span> n1,</span><br><span class="line">             <span class="number">2</span> <span class="keyword">as</span> n2,</span><br><span class="line">             <span class="number">3</span> <span class="keyword">as</span> n3,</span><br><span class="line">             <span class="number">4</span> <span class="keyword">as</span> n4,</span><br><span class="line">             <span class="number">5</span> <span class="keyword">as</span> n5))</span><br><span class="line">     )</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t5;</span><br></pre></td></tr></table></figure>

<p><img data-src="http://cdn.qiyunzhou.top/oracle/202203141424303.png"></p>
<h4 id="5-6"><a href="#5-6" class="headerlink" title="5.6"></a>5.6</h4><h2 id="6-PLSQL编程语言"><a href="#6-PLSQL编程语言" class="headerlink" title="6.PLSQL编程语言"></a>6.PLSQL编程语言</h2><h3 id="6-1-定义变量"><a href="#6-1-定义变量" class="headerlink" title="6.1 定义变量"></a>6.1 定义变量</h3><p>赋值操作可以使用:=也可以使用into查询语句赋值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">    i number(<span class="number">2</span>) :<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line">		s varchar2(<span class="number">10</span>) :<span class="operator">=</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">		ena emp.ename<span class="operator">%</span>type;	<span class="comment">-- 引用型变量</span></span><br><span class="line">		emprow emp<span class="operator">%</span>rowtype; <span class="comment">--记录型变量</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">		dbms_output.put_line(s);</span><br><span class="line">		<span class="keyword">select</span> ename <span class="keyword">into</span> ena <span class="keyword">from</span> emp <span class="keyword">where</span> empno<span class="operator">=</span><span class="number">7788</span>;</span><br><span class="line">		dbms_output.put_line(ena);</span><br><span class="line">		<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> emprow <span class="keyword">from</span> emp <span class="keyword">where</span> empno<span class="operator">=</span><span class="number">7788</span>;</span><br><span class="line">		dbms_output.put_line(emprow.ename <span class="operator">||</span> <span class="string">&#x27;的工作为：&#x27;</span><span class="operator">||</span>emprow.job);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-if语句"><a href="#6-2-if语句" class="headerlink" title="6.2 if语句"></a>6.2 if语句</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---输入小于18的数字，输出未成年</span></span><br><span class="line"><span class="comment">---输入大于18小于40的数字，输出中年人</span></span><br><span class="line"><span class="comment">---输入大于40的数字，输出老年人</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  i number(<span class="number">3</span>) :<span class="operator">=</span> <span class="operator">&amp;</span>i;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  if i<span class="operator">&lt;</span><span class="number">18</span> <span class="keyword">then</span></span><br><span class="line">    dbms_output.put_line(<span class="string">&#x27;未成年&#x27;</span>);</span><br><span class="line">  elsif i<span class="operator">&lt;</span><span class="number">40</span> <span class="keyword">then</span></span><br><span class="line">    dbms_output.put_line(<span class="string">&#x27;中年人&#x27;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    dbms_output.put_line(<span class="string">&#x27;老年人&#x27;</span>);</span><br><span class="line">  <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-循环"><a href="#6-3-循环" class="headerlink" title="6.3 循环"></a>6.3 循环</h3><p>用三种方式输出1到10是个数字</p>
<p>while循环</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">  i number(<span class="number">2</span>) :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  while i <span class="operator">&lt;</span> <span class="number">11</span> loop</span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">    i :<span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<p>exit循环</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">  i number(<span class="number">2</span>) :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  loop</span><br><span class="line">    exit <span class="keyword">when</span> i <span class="operator">&gt;</span> <span class="number">10</span>;</span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">    i :<span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<p>for循环</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span> .. <span class="number">10</span> loop</span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-4-游标"><a href="#6-4-游标" class="headerlink" title="6.4 游标"></a>6.4 游标</h3><p>游标：可以存放多个对象，多行记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---输出emp表中所有员工的姓名</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="keyword">cursor</span> c1 <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line">  emprow emp<span class="operator">%</span>rowtype;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">open</span> c1;</span><br><span class="line">        loop</span><br><span class="line">            <span class="keyword">fetch</span> c1 <span class="keyword">into</span> emprow;</span><br><span class="line">            exit <span class="keyword">when</span> c1<span class="operator">%</span>notfound;</span><br><span class="line">            dbms_output.put_line(emprow);</span><br><span class="line">        <span class="keyword">end</span> loop;</span><br><span class="line">   <span class="keyword">close</span> c1;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 给指定部门员工涨工资</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="keyword">cursor</span> c2(eno emp.deptno<span class="operator">%</span>type) <span class="keyword">is</span> <span class="keyword">select</span> empno <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">=</span>eno;</span><br><span class="line">   en emp.empno<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">open</span> c2(<span class="number">10</span>);</span><br><span class="line">       loop</span><br><span class="line">         <span class="keyword">fetch</span> c2 <span class="keyword">into</span> en;</span><br><span class="line">         exit <span class="keyword">when</span> c2<span class="operator">%</span>notfound;</span><br><span class="line">         update emp <span class="keyword">set</span> sal<span class="operator">=</span>sal<span class="number">-100</span> <span class="keyword">where</span> empno<span class="operator">=</span>en;</span><br><span class="line">         <span class="keyword">commit</span>;</span><br><span class="line">        <span class="keyword">end</span> loop;</span><br><span class="line">  <span class="keyword">close</span> c2;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-5-存储过程"><a href="#6-5-存储过程" class="headerlink" title="6.5 存储过程"></a>6.5 存储过程</h3><p>存储过程就是一段提前编译好的sql语句，放置在数据库端，可以直接被调用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> p1 (eno emp.empno<span class="operator">%</span>type) <span class="keyword">is</span> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  update emp <span class="keyword">set</span> sal<span class="operator">=</span>sal<span class="operator">+</span><span class="number">100</span> <span class="keyword">where</span> empno<span class="operator">=</span>eno;</span><br><span class="line">  <span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-6-存储函数"><a href="#6-6-存储函数" class="headerlink" title="6.6 存储函数"></a>6.6 存储函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> f_yearsal(eno emp.empno<span class="operator">%</span>type) <span class="keyword">return</span> number </span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">      res number(<span class="number">10</span>); </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">select</span> sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>nvl(comm, <span class="number">0</span>) <span class="keyword">into</span> res <span class="keyword">from</span> emp <span class="keyword">where</span> empno <span class="operator">=</span> eno;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">-- 测试</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  res number(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  res :<span class="operator">=</span> f_yearsal(<span class="number">7788</span>);</span><br><span class="line">  dbms_output.put_line(res);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-7-out类型参数"><a href="#6-7-out类型参数" class="headerlink" title="6.7 out类型参数"></a>6.7 out类型参数</h3><p>in和out类型参数的区别是什么？<br>凡是涉及到into查询语句赋值或者:=赋值操作的参数，都必须使用out来修饰。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> p_yearsal(eno emp.empno<span class="operator">%</span>type, yearsal <span class="keyword">out</span> number) <span class="keyword">is</span></span><br><span class="line">    s number(<span class="number">10</span>); </span><br><span class="line">    c emp.comm<span class="operator">%</span>type;   </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">select</span> sal<span class="operator">*</span><span class="number">12</span>,nvl(comm,<span class="number">0</span>) <span class="keyword">into</span> s,c <span class="keyword">from</span> emp <span class="keyword">where</span> empno<span class="operator">=</span>eno;</span><br><span class="line">    yearsal :<span class="operator">=</span> s<span class="operator">+</span>c;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">-- 测试</span></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">    yearsal number(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    p_yearsal(<span class="number">7788</span>,yearsal);</span><br><span class="line">    dbms_output.put_line(yearsal);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-8-触发器"><a href="#6-8-触发器" class="headerlink" title="6.8 触发器"></a>6.8 触发器</h3><p>触发器，就是制定一个规则，在我们做增删改操作的时候，只要满足该规则，自动触发，无需调用。<br>    语句级触发器：不包含有for each row的触发器。<br>    行级触发器：包含有for each row的就是行级触发器。<br>    加for each row是为了使用:old或者:new对象或者一行记录。<br>语句级触发器    </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> t1 </span><br><span class="line">after</span><br><span class="line"><span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> person</span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;一个新员工入职&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<p>行级别触发器</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---raise_application_error(-20001~-20999之间, &#x27;错误提示信息&#x27;);</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> t2</span><br><span class="line">before</span><br><span class="line">update</span><br><span class="line"><span class="keyword">on</span> emp</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   if :old.sal<span class="operator">&gt;</span>:new.sal <span class="keyword">then</span></span><br><span class="line">       raise_application_error(<span class="number">-20001</span>,<span class="string">&#x27;不能给员工降薪&#x27;</span>);</span><br><span class="line">   <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<p>触发器实现主键自增。【行级触发器】</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---分析：在用户做插入操作的之前，拿到即将插入的数据，给该数据中的主键列赋值。</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> auid</span><br><span class="line">before</span><br><span class="line"><span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> person</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">select</span> s_person.nextval <span class="keyword">into</span> :new.id <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>


<h2 id="7-Oracle-常用系统包"><a href="#7-Oracle-常用系统包" class="headerlink" title="7. Oracle 常用系统包"></a>7. Oracle 常用系统包</h2><blockquote>
<p>Oracle常用系统包 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/champaign/p/9468354.html">https://www.cnblogs.com/champaign/p/9468354.html</a></p>
</blockquote>
<h2 id="8-执行计划"><a href="#8-执行计划" class="headerlink" title="8. 执行计划"></a>8. 执行计划</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在执行的<span class="keyword">sql</span>前加explain plan <span class="keyword">for</span></span><br><span class="line">#查看：</span><br><span class="line"><span class="keyword">select</span> plan_table_output <span class="keyword">from</span> <span class="keyword">table</span>(DBMS_XPLAN.DISPLAY(<span class="string">&#x27;PLAN_TABLE&#x27;</span>));</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">table</span>(dbms_xplan.display);</span><br></pre></td></tr></table></figure>

<h2 id="9-数据导入与导出"><a href="#9-数据导入与导出" class="headerlink" title="9. 数据导入与导出"></a>9. 数据导入与导出</h2><p><strong>导出</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp <span class="keyword">system</span><span class="operator">/</span>root 添加参数 file<span class="operator">=</span>文件名 就是整库导出 <span class="keyword">full</span><span class="operator">=</span>y</span><br></pre></td></tr></table></figure>

<p>执行命令后会在当前目录下生成一个叫 EXPDAT.DMP的文件，此文件为备份文件。添加参数 full=y 就是整库导出，file参数可指定文件名</p>
<p><strong>导入</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp <span class="keyword">system</span><span class="operator">/</span>itcast <span class="keyword">full</span><span class="operator">=</span>y file<span class="operator">=</span>water.dmp </span><br></pre></td></tr></table></figure>

<p><strong>按用户导出与导入</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exp <span class="keyword">system</span><span class="operator">/</span>itcast owner<span class="operator">=</span>wateruser file<span class="operator">=</span>wateruser.dmp </span><br><span class="line">imp <span class="keyword">system</span><span class="operator">/</span>itcast  file<span class="operator">=</span>wateruser.dmp fromuser<span class="operator">=</span>wateruser </span><br></pre></td></tr></table></figure>

<p><strong>按表导出与导入</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exp wateruser<span class="operator">/</span>itcast file<span class="operator">=</span>a.dmp tables<span class="operator">=</span>t_account,a_area </span><br><span class="line">imp wateruser<span class="operator">/</span>itcast file<span class="operator">=</span>a.dmp tables<span class="operator">=</span>t_account,a_area </span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Oracle/" rel="tag"><i class="fa fa-tag"></i> Oracle</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/2/" rel="prev" title="docker">
      <i class="fa fa-chevron-left"></i> docker
    </a></div>
      <div class="post-nav-item">
    <a href="/post/5/" rel="next" title="mybatis-plus lambda链式调用">
      mybatis-plus lambda链式调用 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#oracle"><span class="nav-text">oracle</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-text">1.基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">1.1 数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E5%AE%9E%E4%BE%8B"><span class="nav-text">1.2 实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E8%A1%A8%E7%A9%BA%E9%97%B4"><span class="nav-text">1.3 表空间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-%E7%94%A8%E6%88%B7"><span class="nav-text">1.4 用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%EF%BC%88dbf%E3%80%81ora"><span class="nav-text">1.5 数据文件（dbf、ora)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-%E5%BA%8F%E5%88%97"><span class="nav-text">1.6 序列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-7-%E4%BC%AA%E5%88%97"><span class="nav-text">1.7 伪列</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%A1%A8%E7%A9%BA%E9%97%B4"><span class="nav-text">2. 表空间</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%A9%BA%E9%97%B4"><span class="nav-text">2.1 创建表空间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E5%88%A0%E9%99%A4%E8%A1%A8%E7%A9%BA%E9%97%B4"><span class="nav-text">2.2 删除表空间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E7%94%A8%E6%88%B7"><span class="nav-text">2.3 用户</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-oracle%E5%87%BD%E6%95%B0"><span class="nav-text">3. oracle函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E6%95%B0%E5%80%BC%E5%9E%8B%E5%87%BD%E6%95%B0"><span class="nav-text">3.1 数值型函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#round-x%EF%BC%8C-y"><span class="nav-text">round(x，[y])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#trunc-number-decimals"><span class="nav-text">trunc(number,[decimals])</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E5%AD%97%E7%AC%A6%E5%9E%8B%E5%87%BD%E6%95%B0"><span class="nav-text">3.2 字符型函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#instr-c1-c2-x-y"><span class="nav-text">instr(c1,c2[,x],[y])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#lpad-c1-n-c2"><span class="nav-text">lpad(c1,n[,c2])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rpad-c1-n-c2"><span class="nav-text">rpad(c1,n[,c2])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ltrim-c1-c2"><span class="nav-text">ltrim(c1,[,c2])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rtrim-c1-c2"><span class="nav-text">rtrim(c1,[,c2])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#replace-c1-c2-c3"><span class="nav-text">replace(c1,c2[,c3])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#substr-c1-n1-n2"><span class="nav-text">substr(c1,n1[,n2])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#translate-c1-c2-c3"><span class="nav-text">translate(c1,c2,c3)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#trim-c1-from-c2"><span class="nav-text">trim(c1 from c2)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="nav-text">3.3 日期函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#round-d1-c1"><span class="nav-text">round(d1[,c1])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#trunc-d1-c1"><span class="nav-text">trunc(d1[,c1])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#extract-c1-from-d1"><span class="nav-text">extract(c1 from d1)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#interval"><span class="nav-text">interval</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#numtodsinterval"><span class="nav-text">numtodsinterval</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A0%E5%87%8F%E6%97%A5%E6%9C%88%E5%B9%B4"><span class="nav-text">加减日月年</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A0%E5%87%8F%E6%97%B6%E5%88%86%E7%A7%92"><span class="nav-text">加减时分秒</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E4%B8%A4%E4%B8%AA%E6%97%A5%E6%9C%9F%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%A4%A9%E6%95%B0"><span class="nav-text">计算两个日期之间的工作天数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%97%A5%E6%9C%9F%E5%8F%96%E5%80%BC"><span class="nav-text">常用日期取值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A1%AE%E5%AE%9A%E4%B8%80%E5%B9%B4%E6%98%AF%E5%90%A6%E4%B8%BA%E9%97%B0%E5%B9%B4"><span class="nav-text">确定一年是否为闰年</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A1%AE%E5%AE%9A%E4%B8%80%E5%B9%B4%E5%86%85%E5%B1%9E%E4%BA%8E%E5%91%A8%E5%86%85%E6%9F%90%E4%B8%80%E5%A4%A9%E7%9A%84%E6%89%80%E6%9C%89%E6%97%A5%E6%9C%9F"><span class="nav-text">确定一年内属于周内某一天的所有日期</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0"><span class="nav-text">3.4转换函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TO-CHAR-x-c2-C3-C4"><span class="nav-text">TO_CHAR(x[[[,c2],C3],C4])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TO-DATE-X-c2-c3"><span class="nav-text">TO_DATE(X[,c2[,c3]])</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0"><span class="nav-text">3.5 其他函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#case-when"><span class="nav-text">case when</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nvl-nvl2"><span class="nav-text">nvl() nvl2()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#COALESCE"><span class="nav-text">COALESCE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DECODE"><span class="nav-text">DECODE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#listagg"><span class="nav-text">listagg()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pivot"><span class="nav-text">pivot</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#unpivot"><span class="nav-text">unpivot</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#group-by%E3%80%81rollup%E3%80%81cube"><span class="nav-text">group by、rollup、cube</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6%E5%88%86%E6%9E%90%E5%87%BD%E6%95%B0"><span class="nav-text">3.6分析函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SUM-OVER"><span class="nav-text">SUM() OVER()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rows-between"><span class="nav-text">rows between</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#range-between"><span class="nav-text">range between</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#COUNT-OVER"><span class="nav-text">COUNT() OVER()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#avg-over"><span class="nav-text">avg() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#min-over"><span class="nav-text">min() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#max-over"><span class="nav-text">max() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rank-over"><span class="nav-text">rank() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dense-rank"><span class="nav-text">dense_rank()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#row-number-over"><span class="nav-text">row_number() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ntile-n-over"><span class="nav-text">ntile(n) over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#first-value-over"><span class="nav-text">first_value() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#last-value-over"><span class="nav-text">last_value() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#lag-over"><span class="nav-text">lag() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#lead-over"><span class="nav-text">lead() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ratio-to-report-over"><span class="nav-text">ratio_to_report() over()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MAX-KEEP"><span class="nav-text">MAX()   KEEP()</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-%E6%A0%91%E7%8A%B6%E7%BB%93%E6%9E%84%E5%B1%82%E7%BA%A7%E6%9F%A5%E8%AF%A2"><span class="nav-text">3.7 树状结构层级查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E6%A0%91%E7%8A%B6%E6%9F%A5%E8%AF%A2"><span class="nav-text">简单树状查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E8%8A%82%E7%82%B9%E3%80%81%E5%88%86%E6%94%AF%E8%8A%82%E7%82%B9%E3%80%81%E5%8F%B6%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-text">根节点、分支节点、叶子节点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%91%E5%BD%A2%E6%9F%A5%E8%AF%A2%E4%B8%AD%E7%9A%84%E6%8E%92%E5%BA%8F"><span class="nav-text">树形查询中的排序</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="nav-text">4. 常用操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E6%8B%BC%E6%8E%A5%E5%88%97"><span class="nav-text">4.1 拼接列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E9%99%90%E5%88%B6%E8%BF%94%E5%9B%9E%E7%9A%84%E8%A1%8C%E6%95%B0"><span class="nav-text">4.2 限制返回的行数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-%E9%9A%8F%E6%9C%BA%E8%BF%94%E5%9B%9En%E6%9D%A1%E8%AE%B0%E5%BD%95"><span class="nav-text">4.3 随机返回n条记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-%E6%8E%92%E5%BA%8F"><span class="nav-text">4.4 排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-in%E3%80%81exists"><span class="nav-text">4.5 in、exists</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-%E8%A1%8C%E8%A1%8C%E6%AF%94%E8%BE%83"><span class="nav-text">4.6 行行比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-%E6%8F%92%E5%85%A5%E3%80%81%E6%9B%B4%E6%96%B0%E4%B8%8E%E5%88%A0%E9%99%A4"><span class="nav-text">4.7 插入、更新与删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-WITH-CHECK-OPTION"><span class="nav-text">4.8 WITH  CHECK  OPTION</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-9-%E5%A4%9A%E8%A1%A8%E6%8F%92%E5%85%A5"><span class="nav-text">4.9 多表插入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#INSERT-ALL"><span class="nav-text">INSERT ALL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#INSERT-FIRST"><span class="nav-text">INSERT FIRST</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-10-MERGE-INTO"><span class="nav-text">4.10 MERGE INTO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-11-%E8%8C%83%E5%9B%B4%E5%A4%84%E7%90%86"><span class="nav-text">4.11 范围处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%BD%8D%E8%BF%9E%E7%BB%AD%E5%80%BC%E8%8C%83%E5%9B%B4%E7%9A%84%E5%BC%80%E5%A7%8B%E7%82%B9%E5%92%8C%E7%BB%93%E6%9D%9F%E7%82%B9"><span class="nav-text">定位连续值范围的开始点和结束点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%88%E5%B9%B6%E6%97%B6%E9%97%B4%E6%AE%B5"><span class="nav-text">合并时间段</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2"><span class="nav-text">5. 高级查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E7%BB%93%E6%9E%9C%E9%9B%86%E5%88%86%E9%A1%B5"><span class="nav-text">5.1 结果集分页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E8%B7%B3%E8%BF%87%E8%A1%A8%E4%B8%ADn%E8%A1%8C"><span class="nav-text">5.2 跳过表中n行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-%E6%8E%92%E5%88%97%E7%BB%84%E5%90%88%E5%8E%BB%E9%87%8D"><span class="nav-text">5.3 排列组合去重</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-4-%E6%8A%91%E5%88%B6%E7%BB%93%E6%9E%9C%E9%9B%86%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E5%80%BC"><span class="nav-text">5.4 抑制结果集中的重复值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-5-%E7%BB%99%E6%95%B0%E6%8D%AE%E5%88%86%E7%BB%84"><span class="nav-text">5.5 给数据分组</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-6"><span class="nav-text">5.6</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-PLSQL%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80"><span class="nav-text">6.PLSQL编程语言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="nav-text">6.1 定义变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-if%E8%AF%AD%E5%8F%A5"><span class="nav-text">6.2 if语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-%E5%BE%AA%E7%8E%AF"><span class="nav-text">6.3 循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-%E6%B8%B8%E6%A0%87"><span class="nav-text">6.4 游标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-5-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-text">6.5 存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-6-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="nav-text">6.6 存储函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-7-out%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="nav-text">6.7 out类型参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-8-%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-text">6.8 触发器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-Oracle-%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E5%8C%85"><span class="nav-text">7. Oracle 常用系统包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="nav-text">8. 执行计划</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E4%B8%8E%E5%AF%BC%E5%87%BA"><span class="nav-text">9. 数据导入与导出</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="yunzhou"
      src="/uploads/boy.jpg">
  <p class="site-author-name" itemprop="name">yunzhou</p>
  <div class="site-description" itemprop="description">看呐！那朵云好像一朵云</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/codeyunzhou" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;codeyunzhou" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:15086314018@163.com" title="E-Mail → mailto:15086314018@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width=100%">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bug/" rel="tag">Bug</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RocketMQ/" rel="tag">RocketMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag">css</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle/" rel="tag">gradle</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/" rel="tag">html</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uml/" rel="tag">uml</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E5%8F%B0/" rel="tag">后台</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/" rel="tag">定时任务</a><span class="tag-list-count">1</span></li></ul>
        </canvas>
    </div>
</div>


      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yunzhou</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">190k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:53</span>
</div>

</br>
<a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">黔ICP备20001576号-1</a>
</br>
<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=52052202522527" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img src="/uploads/beian.png" style="float:left;"/><p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">贵公网安备 52052202522527号</p></a>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
